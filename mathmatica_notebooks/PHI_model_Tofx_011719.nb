(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    135341,       3283]
NotebookOptionsPosition[    131756,       3170]
NotebookOutlinePosition[    132144,       3187]
CellTagsIndexPosition[    132101,       3184]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData["alphaC"], "Input",
 CellChangeTimes->{{3.7564858848654757`*^9, 3.756485885980919*^9}}],

Cell[BoxData["alphaC"], "Output",
 CellChangeTimes->{{3.7564858867218018`*^9, 3.756485939081976*^9}, 
   3.756488981874139*^9, 3.756505545374962*^9, 3.756505672323539*^9, 
   3.756932694246622*^9}]
}, Open  ]],

Cell["\<\
define constants, important parameters
Revisions as of 011419
\t1) include particle volume as variable instead of fixed parameter so \
particles can be different sizes\
\>", "Text",
 CellChangeTimes->{{3.736691598193976*^9, 3.736691612551216*^9}, 
   3.7413587757498302`*^9, 3.7564801856095877`*^9, {3.756481873756422*^9, 
   3.7564819376568947`*^9}, 3.756482697158201*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{"2.998", "*", 
    SuperscriptBox["10", "10"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hbar", " ", "=", " ", 
   RowBox[{"6582", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "19"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"nm", "[", "l_", "]"}], ":=", 
    RowBox[{"l", "*", 
     RowBox[{"10", "^", 
      RowBox[{"-", "7"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{"2.48", "/", "hbar"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e", "=", 
   RowBox[{"4.803", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "10"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Em", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"a", " ", "=", " ", 
     RowBox[{"nm", "[", "40", "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]l", "=", 
   RowBox[{"nm", "[", "500", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sensorWidth", "=", " ", "2000"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Z", "[", 
      RowBox[{"w_", ",", "wR_", ",", "gam_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"w", "^", "2"}], " ", "-", " ", 
      RowBox[{"wR", "^", "2"}], " ", "+", " ", 
      RowBox[{"I", " ", "gam", " ", "w"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Z1", "[", "w_", "]"}], ":=", 
     RowBox[{"Z", "[", 
      RowBox[{"w", ",", "w1", ",", "\[Gamma]1"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Z2", "[", "w_", "]"}], ":=", 
     RowBox[{"Z", "[", 
      RowBox[{"w", ",", "w2", ",", "\[Gamma]2"}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"totalDrivePower", " ", "=", " ", 
     RowBox[{"377.1726532143218", "*", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{"-", "9"}], ")"}]}], " ", "*", " ", 
      RowBox[{"c", "/", 
       RowBox[{"(", 
        RowBox[{"8", "\[Pi]"}], ")"}]}]}]}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.736277304608989*^9, 3.736277429499052*^9}, 
   3.736277509054009*^9, {3.7362776186673717`*^9, 3.7362777360065613`*^9}, {
   3.736278066872148*^9, 3.736278095065462*^9}, {3.7362783470904083`*^9, 
   3.736278411489357*^9}, {3.736278474520225*^9, 3.736278506383772*^9}, {
   3.736278551805279*^9, 3.7362785872795*^9}, {3.736278755410483*^9, 
   3.736278798057623*^9}, {3.73627914972151*^9, 3.736279624745615*^9}, {
   3.736279674751285*^9, 3.7362796796154118`*^9}, {3.736279713017421*^9, 
   3.736279728663067*^9}, {3.736279886862301*^9, 3.736280002051259*^9}, {
   3.7362800490190973`*^9, 3.736280077940564*^9}, {3.736280264175458*^9, 
   3.736280265812478*^9}, {3.736280297951498*^9, 3.7362803011151342`*^9}, {
   3.736280663193067*^9, 3.736280678501384*^9}, 3.736280761416399*^9, {
   3.7362810530259132`*^9, 3.7362811238455143`*^9}, {3.736281220844096*^9, 
   3.736281226156616*^9}, {3.736281259391741*^9, 3.7362812604052343`*^9}, {
   3.736618620019681*^9, 3.7366186429495897`*^9}, {3.7366199921620073`*^9, 
   3.736619998418211*^9}, {3.7366861736974382`*^9, 3.736686343900984*^9}, {
   3.7366863847687197`*^9, 3.736686527529858*^9}, {3.73668840384112*^9, 
   3.736688474529619*^9}, 3.736734762649407*^9, 3.740075556402219*^9, {
   3.740075608750519*^9, 3.740075608868795*^9}, 3.7400986334361353`*^9, {
   3.740849753774268*^9, 3.740849757538999*^9}, {3.756480249321042*^9, 
   3.756480263386623*^9}, {3.7564803279653063`*^9, 3.75648033803683*^9}, 
   3.7564808846004333`*^9, {3.756481581672593*^9, 3.756481581739114*^9}, 
   3.7565056680433083`*^9}],

Cell["Focused driving field of probe beam", "Text",
 CellChangeTimes->{{3.736691621825822*^9, 3.736691631538137*^9}}],

Cell[CellGroupData[{

Cell["\<\
Scan, only glycerol changes with temperature, difference version\
\>", "Subsubsection",
 CellChangeTimes->{{3.7366866076819143`*^9, 3.73668660805783*^9}, {
  3.736686863017342*^9, 3.736686871552259*^9}, {3.736686966873348*^9, 
  3.736686978010474*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Eext", "[", 
      RowBox[{"x_", ",", "x0_", ",", "\[Sigma]_"}], "]"}], ":=", 
     RowBox[{"Em", "*", 
      RowBox[{"PDF", "[", 
       RowBox[{
        RowBox[{"NormalDistribution", "[", 
         RowBox[{"x0", ",", "\[Sigma]"}], "]"}], ",", "x"}], "]"}]}]}], ";"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Eext", "[", 
      RowBox[{"x_", ",", "x0_", ",", "w_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SuperscriptBox["10", "2"], "\[IndentingNewLine]", "2", "*", 
         RowBox[{
          RowBox[{"SphericalBesselJ", "[", 
           RowBox[{"1", ",", 
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{"x", "-", "x0"}], ")"}]}]}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"k", 
            RowBox[{"(", 
             RowBox[{"x", "-", "x0"}], ")"}]}], ")"}]}]}], " ", ",", 
        "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
        RowBox[{"-", 
         RowBox[{"SphericalBesselJ", "[", 
          RowBox[{"0", ",", 
           RowBox[{"k", " ", 
            RowBox[{"(", 
             RowBox[{"x", "-", "x0"}], ")"}]}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}], "/.", 
      RowBox[{"k", "\[Rule]", 
       RowBox[{
        RowBox[{"w", "/", "c"}], " ", "*", " ", "1.1"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E1ext", "[", 
      RowBox[{"d_", ",", "x0_", ",", "w_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Eext", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d"}], "/", "2"}], ",", "x0", ",", "w"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E2ext", "[", 
      RowBox[{"d_", ",", "x0_", ",", "w_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Eext", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"+", "d"}], "/", "2"}], ",", "x0", ",", "w"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.736277304608989*^9, 3.736277429499052*^9}, 
   3.736277509054009*^9, {3.7362776186673717`*^9, 3.7362777360065613`*^9}, {
   3.736278066872148*^9, 3.736278095065462*^9}, {3.7362783470904083`*^9, 
   3.736278411489357*^9}, {3.736278474520225*^9, 3.736278506383772*^9}, {
   3.736278551805279*^9, 3.7362785872795*^9}, {3.736278755410483*^9, 
   3.736278798057623*^9}, {3.73627914972151*^9, 3.736279624745615*^9}, {
   3.736279674751285*^9, 3.7362796796154118`*^9}, {3.736279713017421*^9, 
   3.736279728663067*^9}, {3.736279886862301*^9, 3.736280002051259*^9}, {
   3.7362800490190973`*^9, 3.736280077940564*^9}, {3.736280264175458*^9, 
   3.736280265812478*^9}, {3.736280297951498*^9, 3.7362803011151342`*^9}, {
   3.736280663193067*^9, 3.736280678501384*^9}, 3.736280761416399*^9, {
   3.7362810530259132`*^9, 3.7362811238455143`*^9}, {3.736281220844096*^9, 
   3.736281226156616*^9}, {3.736281259391741*^9, 3.7362812604052343`*^9}, {
   3.736618620019681*^9, 3.7366186429495897`*^9}, {3.7366199921620073`*^9, 
   3.736619998418211*^9}, {3.7366861736974382`*^9, 3.736686343900984*^9}, {
   3.7366863847687197`*^9, 3.736686527529858*^9}, {3.73668840384112*^9, 
   3.736688470618759*^9}, 3.736691635624353*^9, {3.7400758630154057`*^9, 
   3.74007586463733*^9}, {3.756480909240961*^9, 3.75648091040071*^9}, {
   3.7564887755626698`*^9, 3.756488797174509*^9}, {3.756488846703483*^9, 
   3.75648886128909*^9}}],

Cell["dipole-dipole coupling strength", "Text",
 CellChangeTimes->{{3.7366916541758537`*^9, 3.736691661534371*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"g", "[", 
     RowBox[{"or_", ",", "d_", ",", "w_"}], "]"}], ":=", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"or", "\[Equal]", "0"}], ",", 
      RowBox[{"(*", " ", 
       RowBox[{
       "x", " ", "oriented", " ", "dipoles", " ", "parallel", " ", "to", " ", 
        "d"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"e", "^", "2"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"I", " ", "k", " ", "d"}]}], ")"}], "/", 
           RowBox[{"d", "^", "3"}]}], " ", ")"}], "*", 
         RowBox[{"E", "^", 
          RowBox[{"(", 
           RowBox[{"I", " ", "k", " ", "d"}], ")"}]}]}], "/.", 
        RowBox[{"k", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"w", "/", "c"}], ")"}]}]}], ")"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"or", "\[Equal]", "1"}], ",", 
      RowBox[{"(*", " ", 
       RowBox[{
       "y", " ", "oriented", " ", "dipoles", " ", "perpendicular", " ", "to", 
        " ", "d"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], 
         RowBox[{"e", "^", "2"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"I", " ", "k", " ", "d"}]}], ")"}], "/", 
            RowBox[{"d", "^", "3"}]}], " ", "-", 
           RowBox[{
            RowBox[{"k", "^", "2"}], " ", "/", 
            RowBox[{"(", "d", ")"}]}]}], ")"}], "*", 
         RowBox[{"E", "^", 
          RowBox[{"(", 
           RowBox[{"I", " ", "k", " ", "d"}], ")"}]}]}], "/.", 
        RowBox[{"k", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"w", "/", "c"}], ")"}]}]}], ")"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.736277304608989*^9, 3.736277429499052*^9}, 
   3.736277509054009*^9, {3.7362776186673717`*^9, 3.7362777360065613`*^9}, {
   3.736278066872148*^9, 3.736278095065462*^9}, {3.7362783470904083`*^9, 
   3.736278411489357*^9}, {3.736278474520225*^9, 3.736278506383772*^9}, {
   3.736278551805279*^9, 3.7362785872795*^9}, {3.736278755410483*^9, 
   3.736278798057623*^9}, {3.73627914972151*^9, 3.736279624745615*^9}, {
   3.736279674751285*^9, 3.7362796796154118`*^9}, {3.736279713017421*^9, 
   3.736279728663067*^9}, {3.736279886862301*^9, 3.736280002051259*^9}, {
   3.7362800490190973`*^9, 3.736280077940564*^9}, {3.736280264175458*^9, 
   3.736280265812478*^9}, {3.736280297951498*^9, 3.7362803011151342`*^9}, {
   3.736280663193067*^9, 3.736280678501384*^9}, 3.736280761416399*^9, {
   3.7362810530259132`*^9, 3.7362811238455143`*^9}, {3.736281220844096*^9, 
   3.736281226156616*^9}, {3.736281259391741*^9, 3.7362812604052343`*^9}, {
   3.736618620019681*^9, 3.7366186429495897`*^9}, {3.7366199921620073`*^9, 
   3.736619998418211*^9}, {3.7366861736974382`*^9, 3.736686343900984*^9}, {
   3.7366863847687197`*^9, 3.736686527529858*^9}, {3.73668840384112*^9, 
   3.736688470618759*^9}, 3.736691635624353*^9, 3.7366916667111*^9, 
   3.736691755434869*^9}],

Cell["\<\
Material parameters and polarizabilities from core-shell expansion\
\>", "Text",
 CellChangeTimes->{{3.7366916711196127`*^9, 3.73669168726469*^9}, 
   3.740843457696661*^9, {3.756503588473027*^9, 3.756503591685556*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eps1", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "2.5676"}], " ", "+", " ", 
    RowBox[{"I", " ", "3.6391"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n0", " ", "=", "1.473"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eps0", " ", "=", " ", 
   RowBox[{"n0", "^", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"deltaNonN", "[", "T_", "]"}], ":=", 
    RowBox[{"2.7", "*", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{"-", "4"}], ")"}]}], "*", 
     RowBox[{"(", "T", ")"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"a", "=", " ", 
     RowBox[{"40", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "7"}]}]}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"alphaC", "[", "a_", "]"}], ":=", 
   RowBox[{
    RowBox[{"a", "^", "3"}], 
    RowBox[{"(", 
     FractionBox[
      RowBox[{"eps1", "-", "eps0"}], 
      RowBox[{"eps1", "+", 
       RowBox[{"2", "eps0"}]}]], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"alphaDelta", "[", 
     RowBox[{"T_", ",", "b_", ",", " ", "a_"}], "]"}], " ", ":=", 
    RowBox[{
     RowBox[{
      FractionBox[
       SuperscriptBox["b", "3"], "3"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "f"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", "f", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox[
            RowBox[{"eps1", "-", "eps0"}], 
            RowBox[{"eps1", "+", 
             RowBox[{"2", "eps0"}]}]], ")"}], "2"]}]}], ")"}], "*", " ", 
      RowBox[{"(", 
       RowBox[{"deltaNonN", "[", "T", "]"}], ")"}]}], "/.", 
     RowBox[{"f", "\[Rule]", 
      FractionBox[
       SuperscriptBox["a", "3"], 
       SuperscriptBox["b", "3"]]}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.736277304608989*^9, 3.736277429499052*^9}, 
   3.736277509054009*^9, {3.7362776186673717`*^9, 3.7362777360065613`*^9}, {
   3.736278066872148*^9, 3.736278095065462*^9}, {3.7362783470904083`*^9, 
   3.736278411489357*^9}, {3.736278474520225*^9, 3.736278506383772*^9}, {
   3.736278551805279*^9, 3.7362785872795*^9}, {3.736278755410483*^9, 
   3.736278798057623*^9}, {3.73627914972151*^9, 3.736279624745615*^9}, {
   3.736279674751285*^9, 3.7362796796154118`*^9}, {3.736279713017421*^9, 
   3.736279728663067*^9}, {3.736279886862301*^9, 3.736280002051259*^9}, {
   3.7362800490190973`*^9, 3.736280077940564*^9}, {3.736280264175458*^9, 
   3.736280265812478*^9}, {3.736280297951498*^9, 3.7362803011151342`*^9}, {
   3.736280663193067*^9, 3.736280678501384*^9}, 3.736280761416399*^9, {
   3.7362810530259132`*^9, 3.7362811238455143`*^9}, {3.736281220844096*^9, 
   3.736281226156616*^9}, {3.736281259391741*^9, 3.7362812604052343`*^9}, {
   3.736618620019681*^9, 3.7366186429495897`*^9}, {3.7366199921620073`*^9, 
   3.736619998418211*^9}, {3.7366861736974382`*^9, 3.736686343900984*^9}, {
   3.7366863847687197`*^9, 3.736686527529858*^9}, {3.73668840384112*^9, 
   3.736688470618759*^9}, 3.736691635624353*^9, 3.7366916667111*^9, {
   3.736691697095406*^9, 3.736691697497896*^9}, 3.740069837963097*^9, {
   3.74007012457121*^9, 3.7400702459100027`*^9}, {3.7400703067321053`*^9, 
   3.740070321988624*^9}, {3.740602701638034*^9, 3.74060270816805*^9}, {
   3.740602775825303*^9, 3.7406028618365793`*^9}, {3.740847963615366*^9, 
   3.740847973863657*^9}, {3.7408499715535727`*^9, 3.740849983023507*^9}, {
   3.756481945763804*^9, 3.756481959227676*^9}, {3.756482273667109*^9, 
   3.756482274347288*^9}}],

Cell["Adding metal variation ", "Text",
 CellChangeTimes->{{3.740602887764278*^9, 3.740602899529029*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", "alphaC"}]], "Input",
 CellChangeTimes->{
  3.740845772347563*^9, {3.7564858633431807`*^9, 3.756485874918741*^9}}],

Cell[BoxData["alphaC"], "Output",
 CellChangeTimes->{
  3.756485875711369*^9, 3.7564859392239428`*^9, {3.756488961495523*^9, 
   3.756488982011217*^9}, 3.7565055455382767`*^9, 3.7565056724531918`*^9, 
   3.7569326944043493`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"deltaCNRonN", "[", "T_", "]"}], ":=", 
   RowBox[{"2.7", "*", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "4"}], ")"}]}], "*", 
    RowBox[{"(", "T", ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"deltaCNIonN", "[", "T_", "]"}], ":=", 
   RowBox[{"4", "*", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "4"}], ")"}]}], "*", 
    RowBox[{"(", "T", ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"np", " ", "=", " ", 
   RowBox[{"Sqrt", "[", 
    FractionBox[
     RowBox[{
      RowBox[{"Abs", "[", "eps1", "]"}], "+", 
      RowBox[{"Re", "[", "eps1", "]"}]}], "2"], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"npp", " ", "=", " ", 
   RowBox[{"Sqrt", "[", 
    FractionBox[
     RowBox[{
      RowBox[{"Abs", "[", "eps1", "]"}], "-", 
      RowBox[{"Re", "[", "eps1", "]"}]}], "2"], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"alphaDeltaCN", "[", 
    RowBox[{"T_", ",", "a_"}], "]"}], " ", ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"6", 
      SuperscriptBox["a", "3"], "eps0"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"eps1", "+", 
        RowBox[{"2", "eps0"}]}], ")"}], "2"]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["np", "2"], 
       RowBox[{"deltaCNRonN", "[", "T", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["npp", "2"], 
       RowBox[{"deltaCNIonN", "[", "T", "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.736691750643461*^9, {3.740602938396387*^9, 3.740602972878866*^9}, {
   3.740603006081761*^9, 3.74060316503365*^9}, {3.740843210531425*^9, 
   3.7408432225251827`*^9}, {3.7408442972309427`*^9, 
   3.7408443089074507`*^9}, {3.740846009133944*^9, 3.7408460724136887`*^9}, {
   3.7408461142312183`*^9, 3.740846114294271*^9}, {3.740847943373402*^9, 
   3.740847944107148*^9}, {3.740847981840455*^9, 3.740848039790028*^9}, {
   3.740849991918335*^9, 3.740849992853993*^9}, {3.756485754150827*^9, 
   3.7564857554239883`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 SuperscriptBox[
  RowBox[{"Re", "[", "eps1", "]"}], 
  RowBox[{"1", "/", "2"}]]], "Input"],

Cell[BoxData[
 RowBox[{"0.`", "\[VeryThinSpace]", "+", 
  RowBox[{"1.6023732399163437`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{
  3.740843563193177*^9, 3.7408480215002604`*^9, 3.74084805166936*^9, 
   3.740849901254333*^9, 3.741358780593397*^9, 3.756481296492806*^9, 
   3.756481584907563*^9, 3.756482707296385*^9, 3.756485807224038*^9, 
   3.7564858418917503`*^9, 3.756485939299692*^9, {3.7564889616120777`*^9, 
   3.756488982091572*^9}, 3.756505545621355*^9, 3.75650567250101*^9, 
   3.756932694505454*^9}]
}, Open  ]],

Cell["Hot and cold dipole moments for difference PTI", "Text",
 CellChangeTimes->{{3.736691703581848*^9, 3.736691714884293*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"p1hot", "[", 
     RowBox[{
     "w_", ",", " ", "T1_", ",", " ", "b1_", ",", "T2_", ",", "b2_", ",", 
      "d_", ",", "x0_", ",", "a1_", ",", "a2_"}], "]"}], ":=", "  ", 
    RowBox[{
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"alpha1", "*", 
          RowBox[{"E1ext", "[", 
           RowBox[{"d", ",", "x0", ",", "w"}], "]"}]}], " ", "+", " ", 
         RowBox[{"alpha1", "*", 
          RowBox[{"g", "[", 
           RowBox[{"0", ",", "d", ",", "w"}], "]"}], "*", "alpha2", "*", 
          RowBox[{"E2ext", "[", 
           RowBox[{"d", ",", "x0", ",", "w"}], "]"}]}]}], ")"}], 
       "\[IndentingNewLine]", "/", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"1", " ", "-", " ", 
         RowBox[{"alpha1", "*", "alpha2", "*", 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{"0", ",", "d", ",", "w"}], "]"}], "^", "2"}]}]}], ")"}]}],
       "\[IndentingNewLine]", ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"alpha1", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"alphaC", "[", "a1", "]"}], "+", 
          RowBox[{"alphaDelta", "[", 
           RowBox[{"T1", ",", "b1", ",", "a1"}], "]"}], " ", "+", " ", 
          RowBox[{"alphaDeltaCN", "[", 
           RowBox[{"T1", ",", "a1"}], "]"}]}], ")"}]}], ",", " ", 
       RowBox[{"alpha2", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"alphaC", "[", "a2", "]"}], "+", 
          RowBox[{"alphaDelta", "[", 
           RowBox[{"T2", ",", "b2", ",", "a2"}], "]"}], "+", 
          RowBox[{"alphaDeltaCN", "[", 
           RowBox[{"T2", ",", "a2"}], "]"}]}], ")"}]}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"p2hot", "[", 
     RowBox[{
     "w_", ",", " ", "T1_", ",", " ", "b1_", ",", "T2_", ",", "b2_", ",", 
      "d_", ",", "x0_", ",", "a1_", ",", "a2_"}], "]"}], ":=", "  ", 
    RowBox[{
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"alpha2", "*", 
          RowBox[{"E2ext", "[", 
           RowBox[{"d", ",", "x0", ",", "w"}], "]"}]}], " ", "+", " ", 
         RowBox[{"alpha2", "*", 
          RowBox[{"g", "[", 
           RowBox[{"0", ",", "d", ",", "w"}], "]"}], "*", "alpha1", "*", 
          RowBox[{"E1ext", "[", 
           RowBox[{"d", ",", "x0", ",", "w"}], "]"}]}]}], ")"}], 
       "\[IndentingNewLine]", "/", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"1", " ", "-", " ", 
         RowBox[{"alpha2", "*", "alpha1", "*", 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{"0", ",", "d", ",", "w"}], "]"}], "^", "2"}]}]}], ")"}]}],
       "\[IndentingNewLine]", ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"alpha1", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"alphaC", "[", "a1", "]"}], "+", 
          RowBox[{"alphaDelta", "[", 
           RowBox[{"T1", ",", "b1", ",", "a1"}], "]"}], " ", "+", " ", 
          RowBox[{"alphaDeltaCN", "[", 
           RowBox[{"T1", ",", "a1"}], "]"}]}], ")"}]}], ",", " ", 
       RowBox[{"alpha2", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"alphaC", "[", "a2", "]"}], "+", 
          RowBox[{"alphaDelta", "[", 
           RowBox[{"T2", ",", "b2", ",", "a2"}], "]"}], "+", 
          RowBox[{"alphaDeltaCN", "[", 
           RowBox[{"T2", ",", "a2"}], "]"}]}], ")"}]}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"p1cold", "[", 
     RowBox[{
     "w_", ",", " ", "T1_", ",", " ", "b1_", ",", "T2_", ",", "b2_", ",", 
      "d_", ",", "x0_", ",", "a1_", ",", "a2_"}], "]"}], ":=", "  ", 
    RowBox[{
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"alpha1", "*", 
          RowBox[{"E1ext", "[", 
           RowBox[{"d", ",", "x0", ",", "w"}], "]"}]}], " ", "+", " ", 
         RowBox[{"alpha1", "*", 
          RowBox[{"g", "[", 
           RowBox[{"0", ",", "d", ",", "w"}], "]"}], "*", "alpha2", "*", 
          RowBox[{"E2ext", "[", 
           RowBox[{"d", ",", "x0", ",", "w"}], "]"}]}]}], ")"}], 
       "\[IndentingNewLine]", "/", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"1", " ", "-", " ", 
         RowBox[{"alpha1", "*", "alpha2", "*", 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{"0", ",", "d", ",", "w"}], "]"}], "^", "2"}]}]}], ")"}]}],
       "\[IndentingNewLine]", ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"alpha1", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"alphaC", "[", "a1", "]"}], ")"}]}], ",", " ", 
       RowBox[{"alpha2", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"alphaC", "[", "a2", "]"}], ")"}]}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p2cold", "[", 
    RowBox[{
    "w_", ",", " ", "T1_", ",", " ", "b1_", ",", "T2_", ",", "b2_", ",", "d_",
      ",", "x0_", ",", "a1_", ",", "a2_"}], "]"}], ":=", "  ", 
   RowBox[{
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"alpha2", "*", 
         RowBox[{"E2ext", "[", 
          RowBox[{"d", ",", "x0", ",", "w"}], "]"}]}], " ", "+", " ", 
        RowBox[{"alpha2", "*", 
         RowBox[{"g", "[", 
          RowBox[{"0", ",", "d", ",", "w"}], "]"}], "*", "alpha1", "*", 
         RowBox[{"E1ext", "[", 
          RowBox[{"d", ",", "x0", ",", "w"}], "]"}]}]}], ")"}], 
      "\[IndentingNewLine]", "/", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{"1", " ", "-", " ", 
        RowBox[{"alpha2", "*", "alpha1", "*", 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"0", ",", "d", ",", "w"}], "]"}], "^", "2"}]}]}], ")"}]}], 
     "\[IndentingNewLine]", ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"alpha1", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"alphaC", "[", "a1", "]"}], ")"}]}], ",", " ", 
      RowBox[{"alpha2", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"alphaC", "[", "a2", "]"}], ")"}]}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.736277304608989*^9, 3.736277429499052*^9}, 
   3.736277509054009*^9, {3.7362776186673717`*^9, 3.7362777360065613`*^9}, {
   3.736278066872148*^9, 3.736278095065462*^9}, {3.7362783470904083`*^9, 
   3.736278411489357*^9}, {3.736278474520225*^9, 3.736278506383772*^9}, {
   3.736278551805279*^9, 3.7362785872795*^9}, {3.736278755410483*^9, 
   3.736278798057623*^9}, {3.73627914972151*^9, 3.736279624745615*^9}, {
   3.736279674751285*^9, 3.7362796796154118`*^9}, {3.736279713017421*^9, 
   3.736279728663067*^9}, {3.736279886862301*^9, 3.736280002051259*^9}, {
   3.7362800490190973`*^9, 3.736280077940564*^9}, {3.736280264175458*^9, 
   3.736280265812478*^9}, {3.736280297951498*^9, 3.7362803011151342`*^9}, {
   3.736280663193067*^9, 3.736280678501384*^9}, 3.736280761416399*^9, {
   3.7362810530259132`*^9, 3.7362811238455143`*^9}, {3.736281220844096*^9, 
   3.736281226156616*^9}, {3.736281259391741*^9, 3.7362812604052343`*^9}, {
   3.736618620019681*^9, 3.7366186429495897`*^9}, {3.7366199921620073`*^9, 
   3.736619998418211*^9}, {3.7366861736974382`*^9, 3.736686343900984*^9}, {
   3.7366863847687197`*^9, 3.736686527529858*^9}, {3.73668840384112*^9, 
   3.736688470618759*^9}, 3.736691635624353*^9, 3.7366916667111*^9, {
   3.736691697095406*^9, 3.736691718410244*^9}, {3.740069752160235*^9, 
   3.7400697786838818`*^9}, {3.740069818820403*^9, 3.740069828224598*^9}, {
   3.7408434694606543`*^9, 3.7408434978749313`*^9}, {3.740850003078429*^9, 
   3.740850012893255*^9}, {3.756481981525741*^9, 3.7564820799631243`*^9}, {
   3.7564822867399187`*^9, 3.7564823718764887`*^9}, {3.756485773752775*^9, 
   3.7564857939823923`*^9}, {3.756488898618519*^9, 3.756488930163237*^9}}],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.7366917464602213`*^9}],

Cell["Total scattered power", "Text",
 CellChangeTimes->{{3.736691722703877*^9, 3.736691741247617*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PscatteredHot", "[", 
    RowBox[{
    "w_", ",", " ", "T1_", ",", " ", "b1_", ",", "T2_", ",", "b2_", ",", "d_",
      ",", "x0_", ",", "a1_", ",", "a2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", "/", "3"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"w", "^", "4"}], "/", 
      RowBox[{"c", "^", "3"}]}], ")"}], "*", 
    RowBox[{"(", "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{"Abs", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p1hot", "[", 
         RowBox[{
         "w", ",", " ", "T1", ",", " ", "b1", ",", "T2", ",", "b2", ",", "d", 
          ",", "x0", ",", "a1", ",", "a2"}], "]"}], "+", " ", 
        RowBox[{"p2hot", "[", 
         RowBox[{
         "w", ",", " ", "T1", ",", " ", "b1", ",", "T2", ",", "b2", ",", "d", 
          ",", "x0", ",", "a1", ",", "a2"}], "]"}]}], "\[IndentingNewLine]", 
       "]"}], "^", "2"}], "\[IndentingNewLine]", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"PscatteredCold", "[", 
     RowBox[{
     "w_", ",", " ", "T1_", ",", " ", "b1_", ",", "T2_", ",", "b2_", ",", 
      "d_", ",", "x0_", ",", "a1_", ",", "a2_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "/", "3"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"w", "^", "4"}], "/", 
       RowBox[{"c", "^", "3"}]}], ")"}], "*", 
     RowBox[{"(", "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"Abs", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"p1cold", "[", 
          RowBox[{
          "w", ",", " ", "T1", ",", " ", "b1", ",", "T2", ",", "b2", ",", "d",
            ",", "x0", ",", "a1", ",", "a2"}], "]"}], " ", "+", " ", 
         RowBox[{"p2cold", "[", 
          RowBox[{
          "w", ",", " ", "T1", ",", " ", "b1", ",", " ", "T2", ",", " ", "b2",
            ",", " ", "d", ",", " ", "x0", ",", " ", "a1", ",", " ", "a2"}], 
          "]"}]}], "\[IndentingNewLine]", "]"}], "^", "2"}], 
      "\[IndentingNewLine]", ")"}]}]}], ";"}], "Code"], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DiffPowerScatt", "[", 
   RowBox[{
   "w_", ",", " ", "T1_", ",", " ", "b1_", ",", "T2_", ",", "b2_", ",", "d_", 
    ",", "x0_", ",", "a1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PscatteredHot", "[", 
     RowBox[{
     "w", ",", " ", "T1", ",", " ", "b1", ",", "T2", ",", "b2", ",", "d", ",",
       "x0", ",", "a1", ",", "a2"}], "]"}], " ", "-", " ", 
    RowBox[{"PscatteredCold", "[", 
     RowBox[{
     "w", ",", " ", "T1", ",", " ", "b1", ",", "T2", ",", "b2", ",", "d", ",",
       "x0", ",", "a1", ",", "a2"}], "]"}]}], "\[IndentingNewLine]", 
   ")"}]}]}], "Input",
 CellChangeTimes->{{3.736277304608989*^9, 3.736277429499052*^9}, 
   3.736277509054009*^9, {3.7362776186673717`*^9, 3.7362777360065613`*^9}, {
   3.736278066872148*^9, 3.736278095065462*^9}, {3.7362783470904083`*^9, 
   3.736278411489357*^9}, {3.736278474520225*^9, 3.736278506383772*^9}, {
   3.736278551805279*^9, 3.7362785872795*^9}, {3.736278755410483*^9, 
   3.736278798057623*^9}, {3.73627914972151*^9, 3.736279624745615*^9}, {
   3.736279674751285*^9, 3.7362796796154118`*^9}, {3.736279713017421*^9, 
   3.736279728663067*^9}, {3.736279886862301*^9, 3.736280002051259*^9}, {
   3.7362800490190973`*^9, 3.736280077940564*^9}, {3.736280264175458*^9, 
   3.736280265812478*^9}, {3.736280297951498*^9, 3.7362803011151342`*^9}, {
   3.736280663193067*^9, 3.736280678501384*^9}, 3.736280761416399*^9, {
   3.7362810530259132`*^9, 3.7362811238455143`*^9}, {3.736281220844096*^9, 
   3.736281226156616*^9}, {3.736281259391741*^9, 3.7362812604052343`*^9}, {
   3.736618620019681*^9, 3.7366186429495897`*^9}, {3.7366199921620073`*^9, 
   3.736619998418211*^9}, {3.7366861736974382`*^9, 3.736686343900984*^9}, {
   3.7366863847687197`*^9, 3.736686527529858*^9}, {3.73668840384112*^9, 
   3.736688470618759*^9}, 3.736691635624353*^9, 3.7366916667111*^9, {
   3.736691697095406*^9, 3.736691718410244*^9}, {3.740098677144009*^9, 
   3.740098678457728*^9}, {3.756482377706695*^9, 3.756482434409918*^9}, {
   3.756503682208782*^9, 3.756503706367257*^9}}],

Cell["each dipole separately...", "Text",
 CellChangeTimes->{{3.740098686428217*^9, 3.740098696840192*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Pp1ScatteredHot", "[", 
     RowBox[{
     "w_", ",", " ", "T1_", ",", " ", "b1_", ",", "T2_", ",", "b2_", ",", 
      "d_", ",", "x0_", ",", "a1_", ",", "a2_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "/", "3"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"w", "^", "4"}], "/", 
       RowBox[{"c", "^", "3"}]}], ")"}], "*", 
     RowBox[{"(", "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"Abs", "[", "\[IndentingNewLine]", 
        RowBox[{"p1hot", "[", 
         RowBox[{
         "w", ",", " ", "T1", ",", " ", "b1", ",", "T2", ",", "b2", ",", "d", 
          ",", "x0", ",", "a1", ",", "a2"}], "]"}], "\[IndentingNewLine]", 
        "]"}], "^", "2"}], "\[IndentingNewLine]", ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Pp2ScatteredHot", "[", 
     RowBox[{
     "w_", ",", " ", "T1_", ",", " ", "b1_", ",", "T2_", ",", "b2_", ",", 
      "d_", ",", "x0_", ",", "a1_", ",", "a2_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "/", "3"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"w", "^", "4"}], "/", 
       RowBox[{"c", "^", "3"}]}], ")"}], "*", 
     RowBox[{"(", "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"Abs", "[", "\[IndentingNewLine]", " ", 
        RowBox[{"p2hot", "[", 
         RowBox[{
         "w", ",", " ", "T1", ",", " ", "b1", ",", "T2", ",", "b2", ",", "d", 
          ",", "x0", ",", "a1", ",", "a2"}], "]"}], "\[IndentingNewLine]", 
        "]"}], "^", "2"}], "\[IndentingNewLine]", ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Pp1ScatteredCold", "[", 
     RowBox[{
     "w_", ",", " ", "T1_", ",", " ", "b1_", ",", "T2_", ",", "b2_", ",", 
      "d_", ",", "x0_", ",", "a1_", ",", "a2_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "/", "3"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"w", "^", "4"}], "/", 
       RowBox[{"c", "^", "3"}]}], ")"}], "*", 
     RowBox[{"(", "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"Abs", "[", "\[IndentingNewLine]", 
        RowBox[{"p1cold", "[", 
         RowBox[{
         "w", ",", " ", "T1", ",", " ", "b1", ",", "T2", ",", "b2", ",", "d", 
          ",", "x0", ",", "a1", ",", "a2"}], "]"}], "\[IndentingNewLine]", 
        "]"}], "^", "2"}], "\[IndentingNewLine]", ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Pp2ScatteredCold", "[", 
    RowBox[{
    "w_", ",", " ", "T1_", ",", " ", "b1_", ",", "T2_", ",", "b2_", ",", "d_",
      ",", "x0_", ",", "a1_", ",", "a2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", "/", "3"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"w", "^", "4"}], "/", 
      RowBox[{"c", "^", "3"}]}], ")"}], "*", 
    RowBox[{"(", "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{"Abs", "[", "\[IndentingNewLine]", " ", 
       RowBox[{"p2cold", "[", 
        RowBox[{
        "w", ",", " ", "T1", ",", " ", "b1", ",", "T2", ",", "b2", ",", "d", 
         ",", "x0", ",", "a1", ",", "a2"}], "]"}], "\[IndentingNewLine]", 
       "]"}], "^", "2"}], "\[IndentingNewLine]", ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.736277304608989*^9, 3.736277429499052*^9}, 
   3.736277509054009*^9, {3.7362776186673717`*^9, 3.7362777360065613`*^9}, {
   3.736278066872148*^9, 3.736278095065462*^9}, {3.7362783470904083`*^9, 
   3.736278411489357*^9}, {3.736278474520225*^9, 3.736278506383772*^9}, {
   3.736278551805279*^9, 3.7362785872795*^9}, {3.736278755410483*^9, 
   3.736278798057623*^9}, {3.73627914972151*^9, 3.736279624745615*^9}, {
   3.736279674751285*^9, 3.7362796796154118`*^9}, {3.736279713017421*^9, 
   3.736279728663067*^9}, {3.736279886862301*^9, 3.736280002051259*^9}, {
   3.7362800490190973`*^9, 3.736280077940564*^9}, {3.736280264175458*^9, 
   3.736280265812478*^9}, {3.736280297951498*^9, 3.7362803011151342`*^9}, {
   3.736280663193067*^9, 3.736280678501384*^9}, 3.736280761416399*^9, {
   3.7362810530259132`*^9, 3.7362811238455143`*^9}, {3.736281220844096*^9, 
   3.736281226156616*^9}, {3.736281259391741*^9, 3.7362812604052343`*^9}, {
   3.736618620019681*^9, 3.7366186429495897`*^9}, {3.7366199921620073`*^9, 
   3.736619998418211*^9}, {3.7366861736974382`*^9, 3.736686343900984*^9}, {
   3.7366863847687197`*^9, 3.736686527529858*^9}, {3.73668840384112*^9, 
   3.736688470618759*^9}, 3.736691635624353*^9, 3.7366916667111*^9, {
   3.736691697095406*^9, 3.736691718410244*^9}, {3.740098677144009*^9, 
   3.740098678457728*^9}, {3.7564824387925253`*^9, 3.756482491895563*^9}, {
   3.756482530952911*^9, 3.756482534592265*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DiffPowerScatt1", "[", 
   RowBox[{
   "w_", ",", " ", "T1_", ",", " ", "b1_", ",", "T2_", ",", "b2_", ",", "d_", 
    ",", "x0_", ",", "a1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pp1ScatteredHot", "[", 
     RowBox[{
     "w", ",", " ", "T1", ",", " ", "b1", ",", "T2", ",", "b2", ",", "d", ",",
       "x0", ",", "a1", ",", "a2"}], "]"}], " ", "\[IndentingNewLine]", "-", 
    " ", 
    RowBox[{"Pp1ScatteredCold", "[", 
     RowBox[{
     "w", ",", " ", "T1", ",", " ", "b1", ",", "T2", ",", "b2", ",", "d", ",",
       "x0", ",", "a1", ",", "a2"}], "]"}]}], "\[IndentingNewLine]", 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DiffPowerScatt2", "[", 
   RowBox[{
   "w_", ",", " ", "T1_", ",", " ", "b1_", ",", "T2_", ",", "b2_", ",", "d_", 
    ",", "x0_", ",", "a1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pp2ScatteredHot", "[", 
     RowBox[{
     "w", ",", " ", "T1", ",", " ", "b1", ",", "T2", ",", "b2", ",", "d", ",",
       "x0", ",", "a1", ",", "a2"}], "]"}], " ", "\[IndentingNewLine]", "-", 
    " ", 
    RowBox[{"Pp2ScatteredCold", "[", 
     RowBox[{
     "w", ",", " ", "T1", ",", " ", "b1", ",", "T2", ",", "b2", ",", "d", ",",
       "x0", ",", "a1", ",", "a2"}], "]"}]}], "\[IndentingNewLine]", 
   ")"}]}]}], "Input",
 CellChangeTimes->{
  3.736620033724201*^9, {3.7366865594169493`*^9, 3.7366865938287077`*^9}, {
   3.756482517681672*^9, 3.756482536383429*^9}}],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.736691768790204*^9}],

Cell["Plots", "Text",
 CellChangeTimes->{{3.736691774603099*^9, 3.736691775228797*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"DiffPowerScatt", "[", 
        RowBox[{
         RowBox[{"2.48", "/", "hbar"}], ",", "T1", ",", 
         RowBox[{"nm", "[", "b1", "]"}], ",", "T2", ",", 
         RowBox[{"nm", "[", "b2", "]"}], ",", 
         RowBox[{"nm", "[", "d", "]"}], ",", 
         RowBox[{"nm", "[", "x0", "]"}], ",", 
         RowBox[{"nm", "[", "a1", "]"}], ",", 
         RowBox[{"nm", "[", "a2", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x0", ",", 
         RowBox[{
          RowBox[{"-", "sensorWidth"}], "/", "2"}], ",", 
         RowBox[{"sensorWidth", "/", "2"}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"DiffPowerScatt1", "[", 
        RowBox[{
         RowBox[{"2.48", "/", "hbar"}], ",", "T1", ",", 
         RowBox[{"nm", "[", "b1", "]"}], ",", "T2", ",", 
         RowBox[{"nm", "[", "b2", "]"}], ",", 
         RowBox[{"nm", "[", "d", "]"}], ",", 
         RowBox[{"nm", "[", "x0", "]"}], ",", 
         RowBox[{"nm", "[", "a1", "]"}], ",", 
         RowBox[{"nm", "[", "a2", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x0", ",", 
         RowBox[{
          RowBox[{"-", "sensorWidth"}], "/", "2"}], ",", 
         RowBox[{"sensorWidth", "/", "2"}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
       RowBox[{"PlotStyle", "\[Rule]", "Green"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"DiffPowerScatt2", "[", 
        RowBox[{
         RowBox[{"2.48", "/", "hbar"}], ",", "T1", ",", 
         RowBox[{"nm", "[", "b1", "]"}], ",", "T2", ",", 
         RowBox[{"nm", "[", "b2", "]"}], ",", 
         RowBox[{"nm", "[", "d", "]"}], ",", 
         RowBox[{"nm", "[", "x0", "]"}], ",", 
         RowBox[{"nm", "[", "a1", "]"}], ",", 
         RowBox[{"nm", "[", "a2", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x0", ",", 
         RowBox[{
          RowBox[{"-", "sensorWidth"}], "/", "2"}], ",", 
         RowBox[{"sensorWidth", "/", "2"}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Gray"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Gray", ",", 
         RowBox[{"PointSize", "[", ".05", "]"}], ",", 
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"d", "/", "2"}], ",", "0"}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", "Green", ",", 
         RowBox[{"PointSize", "[", ".05", "]"}], ",", 
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "d"}], "/", "2"}], ",", "0"}], "}"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T1", ",", "100"}], "}"}], ",", "1", ",", "200"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T2", ",", "60"}], "}"}], ",", "1", ",", "200"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "100"}], "}"}], ",", "10", ",", 
     RowBox[{"1240", "/", "2.48"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b1", ",", "60"}], "}"}], ",", "41", ",", "100"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b2", ",", "50"}], "}"}], ",", "41", ",", "100"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a1", ",", "40"}], "}"}], ",", "10", ",", "100"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a2", ",", "40"}], "}"}], ",", "10", ",", "100"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.736280364117413*^9, 3.736280430997157*^9}, 
   3.736280466744175*^9, {3.73660047465276*^9, 3.7366005667488947`*^9}, {
   3.736616969740148*^9, 3.73661699625406*^9}, {3.7366185947870483`*^9, 
   3.736618604342739*^9}, {3.7366186513345118`*^9, 3.7366187329587517`*^9}, {
   3.736619967332554*^9, 3.7366199866653976`*^9}, 3.736621981034522*^9, {
   3.7366866382458572`*^9, 3.736686650145863*^9}, {3.736686734247389*^9, 
   3.73668674573468*^9}, 3.740075665105713*^9, {3.756482545415111*^9, 
   3.756482615711278*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a1$$ = 40, $CellContext`a2$$ = 
    40, $CellContext`b1$$ = 60, $CellContext`b2$$ = 50, $CellContext`d$$ = 
    100, $CellContext`T1$$ = 100, $CellContext`T2$$ = 60, Typeset`show$$ = 
    True, Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`T1$$], 100}, 1, 200}, {{
       Hold[$CellContext`T2$$], 60}, 1, 200}, {{
       Hold[$CellContext`d$$], 100}, 10, 500.00000000000006`}, {{
       Hold[$CellContext`b1$$], 60}, 41, 100}, {{
       Hold[$CellContext`b2$$], 50}, 41, 100}, {{
       Hold[$CellContext`a1$$], 40}, 10, 100}, {{
       Hold[$CellContext`a2$$], 40}, 10, 100}}, Typeset`size$$ = {
    450., {134., 141.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`T1$1893$$ = 
    0, $CellContext`T2$1894$$ = 0, $CellContext`d$1895$$ = 
    0, $CellContext`b1$1896$$ = 0, $CellContext`b2$1897$$ = 
    0, $CellContext`a1$1898$$ = 0, $CellContext`a2$1899$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a1$$ = 40, $CellContext`a2$$ = 
        40, $CellContext`b1$$ = 60, $CellContext`b2$$ = 50, $CellContext`d$$ = 
        100, $CellContext`T1$$ = 100, $CellContext`T2$$ = 60}, 
      "ControllerVariables" :> {
        Hold[$CellContext`T1$$, $CellContext`T1$1893$$, 0], 
        Hold[$CellContext`T2$$, $CellContext`T2$1894$$, 0], 
        Hold[$CellContext`d$$, $CellContext`d$1895$$, 0], 
        Hold[$CellContext`b1$$, $CellContext`b1$1896$$, 0], 
        Hold[$CellContext`b2$$, $CellContext`b2$1897$$, 0], 
        Hold[$CellContext`a1$$, $CellContext`a1$1898$$, 0], 
        Hold[$CellContext`a2$$, $CellContext`a2$1899$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Show[
        Plot[
         $CellContext`DiffPowerScatt[
         2.48/$CellContext`hbar, $CellContext`T1$$, 
          $CellContext`nm[$CellContext`b1$$], $CellContext`T2$$, 
          $CellContext`nm[$CellContext`b2$$], 
          $CellContext`nm[$CellContext`d$$], 
          $CellContext`nm[$CellContext`x0], 
          $CellContext`nm[$CellContext`a1$$], 
          $CellContext`nm[$CellContext`a2$$]], {$CellContext`x0, \
(-$CellContext`sensorWidth)/2, $CellContext`sensorWidth/2}, PlotRange -> All], 
        Plot[
         $CellContext`DiffPowerScatt1[
         2.48/$CellContext`hbar, $CellContext`T1$$, 
          $CellContext`nm[$CellContext`b1$$], $CellContext`T2$$, 
          $CellContext`nm[$CellContext`b2$$], 
          $CellContext`nm[$CellContext`d$$], 
          $CellContext`nm[$CellContext`x0], 
          $CellContext`nm[$CellContext`a1$$], 
          $CellContext`nm[$CellContext`a2$$]], {$CellContext`x0, \
(-$CellContext`sensorWidth)/2, $CellContext`sensorWidth/2}, PlotRange -> All, 
         PlotStyle -> Green], 
        Plot[
         $CellContext`DiffPowerScatt2[
         2.48/$CellContext`hbar, $CellContext`T1$$, 
          $CellContext`nm[$CellContext`b1$$], $CellContext`T2$$, 
          $CellContext`nm[$CellContext`b2$$], 
          $CellContext`nm[$CellContext`d$$], 
          $CellContext`nm[$CellContext`x0], 
          $CellContext`nm[$CellContext`a1$$], 
          $CellContext`nm[$CellContext`a2$$]], {$CellContext`x0, \
(-$CellContext`sensorWidth)/2, $CellContext`sensorWidth/2}, PlotRange -> All, 
         PlotStyle -> Gray], 
        Graphics[{Gray, 
          PointSize[0.05], 
          Point[{$CellContext`d$$/2, 0}], Green, 
          PointSize[0.05], 
          Point[{(-$CellContext`d$$)/2, 0}]}, Axes -> True]], 
      "Specifications" :> {{{$CellContext`T1$$, 100}, 1, 
         200}, {{$CellContext`T2$$, 60}, 1, 200}, {{$CellContext`d$$, 100}, 
         10, 500.00000000000006`}, {{$CellContext`b1$$, 60}, 41, 
         100}, {{$CellContext`b2$$, 50}, 41, 100}, {{$CellContext`a1$$, 40}, 
         10, 100}, {{$CellContext`a2$$, 40}, 10, 100}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{505., {274., 281.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.736617116319769*^9, {3.736617353335194*^9, 3.736617359383601*^9}, 
   3.736618671327479*^9, 3.736618701839446*^9, 3.7366187338480597`*^9, {
   3.736621960373259*^9, 3.736621983610574*^9}, {3.736686615301388*^9, 
   3.73668665237423*^9}, 3.736686747153184*^9, 3.7367004148289223`*^9, 
   3.7367059965754347`*^9, 3.7367068336536303`*^9, 3.7367832462059507`*^9, 
   3.736794457725038*^9, 3.740069963064102*^9, 3.740070284830154*^9, 
   3.7400703290340443`*^9, 3.740075614025272*^9, {3.7400756681595592`*^9, 
   3.74007567416546*^9}, 3.740075869299018*^9, 3.740602670062879*^9, 
   3.7406044921414137`*^9, 3.7408417644943*^9, 3.740843516232596*^9, 
   3.740848021690419*^9, 3.740848052556041*^9, 3.7408499014017477`*^9, 
   3.741358784594784*^9, 3.756480985720417*^9, 3.756481296651273*^9, 
   3.756481585045158*^9, 3.756482707433158*^9, 3.756485807347001*^9, 
   3.756485842059224*^9, 3.7564859394587803`*^9, {3.7564889619159393`*^9, 
   3.7564889822712*^9}, 3.756505545806795*^9, 3.7565056726084423`*^9, 
   3.756932697907342*^9}]
}, Open  ]],

Cell["^does not include farfield interference in scattered power ", "Text",
 CellChangeTimes->{{3.7366223102380953`*^9, 3.736622323698256*^9}, 
   3.7366917879101343`*^9}],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.736691780234538*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["focused image, difference calculation", "Subsubsection",
 CellChangeTimes->{{3.736705232194222*^9, 3.736705238029503*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Eplane", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "1.4444", ")"}], "^", "0.5"}], "*", 
    RowBox[{"10", "^", "18"}], "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "1"}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.740075731561863*^9, 3.740075842071382*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"elec", "[", 
    RowBox[{"x_", ",", "w_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"2", "*", 
       RowBox[{
        RowBox[{"SphericalBesselJ", "[", 
         RowBox[{"1", ",", 
          RowBox[{"k", " ", "x"}]}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"k", " ", "x"}], ")"}]}]}], " ", ",", "\[IndentingNewLine]", 
      "0", ",", "\[IndentingNewLine]", 
      RowBox[{"-", 
       RowBox[{"SphericalBesselJ", "[", 
        RowBox[{"0", ",", 
         RowBox[{"k", " ", "x"}]}], "]"}]}]}], "\[IndentingNewLine]", "}"}], "/.", 
    RowBox[{"k", "\[Rule]", 
     RowBox[{"w", "/", "c"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7564860402279377`*^9, 3.756486043696093*^9}, 
   3.756486569809163*^9, {3.756486617150072*^9, 3.7564866205116787`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"p1hotFoc", "[", 
     RowBox[{
     "w_", ",", " ", "T1_", ",", " ", "b1_", ",", "T2_", ",", "b2_", ",", 
      "d_", ",", " ", "a1_", ",", " ", "a2_"}], " ", "]"}], ":=", "  ", 
    RowBox[{
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"alpha1", "*", 
         RowBox[{"(", 
          RowBox[{"1", " ", "+", " ", 
           RowBox[{
            RowBox[{"g", "[", 
             RowBox[{"0", ",", "d", ",", "w"}], "]"}], "*", "alpha2"}]}], 
          ")"}], "*", "Eplane"}], ")"}], "\[IndentingNewLine]", "/", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"1", " ", "-", " ", 
         RowBox[{"alpha1", "*", "alpha2", "*", 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{"0", ",", "d", ",", "w"}], "]"}], "^", "2"}]}]}], ")"}]}],
       "\[IndentingNewLine]", ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"alpha1", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"alphaC", "[", "a1", "]"}], "+", 
          RowBox[{"alphaDelta", "[", 
           RowBox[{"T1", ",", "b1", ",", "a1"}], "]"}], " ", "+", " ", 
          RowBox[{"alphaDeltaCN", "[", 
           RowBox[{"T1", ",", "a1"}], "]"}]}], ")"}]}], ",", " ", 
       RowBox[{"alpha2", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"alphaC", "[", "a2", "]"}], "+", 
          RowBox[{"alphaDelta", "[", 
           RowBox[{"T2", ",", "b2", ",", "a2"}], "]"}], "+", 
          RowBox[{"alphaDeltaCN", "[", 
           RowBox[{"T2", ",", "a2"}], "]"}]}], ")"}]}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"p2hotFoc", "[", 
     RowBox[{
     "w_", ",", " ", "T1_", ",", " ", "b1_", ",", "T2_", ",", "b2_", ",", 
      "d_", ",", " ", "a1_", ",", " ", "a2_"}], "]"}], ":=", "  ", 
    RowBox[{
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"alpha2", "*", 
         RowBox[{"(", 
          RowBox[{"1", " ", "+", " ", 
           RowBox[{
            RowBox[{"g", "[", 
             RowBox[{"0", ",", "d", ",", "w"}], "]"}], "*", "alpha1"}]}], 
          ")"}], "*", "Eplane"}], ")"}], "\[IndentingNewLine]", "/", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"1", " ", "-", " ", 
         RowBox[{"alpha2", "*", "alpha1", "*", 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{"0", ",", "d", ",", "w"}], "]"}], "^", "2"}]}]}], ")"}]}],
       "\[IndentingNewLine]", ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"alpha1", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"alphaC", "[", "a1", "]"}], "+", 
          RowBox[{"alphaDelta", "[", 
           RowBox[{"T1", ",", "b1", ",", "a1"}], "]"}], " ", "+", " ", 
          RowBox[{"alphaDeltaCN", "[", 
           RowBox[{"T1", ",", "a1"}], "]"}]}], ")"}]}], ",", " ", 
       RowBox[{"alpha2", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"alphaC", "[", "a2", "]"}], "+", 
          RowBox[{"alphaDelta", "[", 
           RowBox[{"T2", ",", "b2", ",", "a2"}], "]"}], "+", 
          RowBox[{"alphaDeltaCN", "[", 
           RowBox[{"T2", ",", "a2"}], "]"}]}], ")"}]}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"p1coldFoc", "[", 
     RowBox[{
     "w_", ",", " ", "T1_", ",", " ", "b1_", ",", "T2_", ",", "b2_", ",", 
      "d_", ",", " ", "a1_", ",", " ", "a2_"}], "]"}], ":=", "  ", 
    RowBox[{
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"alpha1", "*", 
         RowBox[{"(", 
          RowBox[{"1", " ", "+", " ", 
           RowBox[{
            RowBox[{"g", "[", 
             RowBox[{"0", ",", "d", ",", "w"}], "]"}], "*", "alpha2"}]}], 
          ")"}], "*", "Eplane"}], ")"}], "\[IndentingNewLine]", "/", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"1", " ", "-", " ", 
         RowBox[{"alpha1", "*", "alpha2", "*", 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{"0", ",", "d", ",", "w"}], "]"}], "^", "2"}]}]}], ")"}]}],
       "\[IndentingNewLine]", ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"alpha1", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"alphaC", "[", "a1", "]"}], ")"}]}], ",", " ", 
       RowBox[{"alpha2", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"alphaC", "[", "a2", "]"}], ")"}]}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p2coldFoc", "[", 
    RowBox[{
    "w_", ",", " ", "T1_", ",", " ", "b1_", ",", "T2_", ",", "b2_", ",", "d_",
      ",", " ", "a1_", ",", " ", "a2_"}], "]"}], ":=", "  ", 
   RowBox[{
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"alpha2", "*", 
        RowBox[{"(", 
         RowBox[{"1", " ", "+", " ", 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{"0", ",", "d", ",", "w"}], "]"}], "*", "alpha1"}]}], 
         ")"}], "*", "Eplane"}], ")"}], "\[IndentingNewLine]", "/", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{"1", " ", "-", " ", 
        RowBox[{"alpha2", "*", "alpha1", "*", 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"0", ",", "d", ",", "w"}], "]"}], "^", "2"}]}]}], ")"}]}], 
     "\[IndentingNewLine]", ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"alpha1", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"alphaC", "[", "a1", "]"}], ")"}]}], ",", " ", 
      RowBox[{"alpha2", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"alphaC", "[", "a2", "]"}], ")"}]}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.736705290715074*^9, 3.736705385256756*^9}, {
  3.736705469934136*^9, 3.736705473875292*^9}, {3.7400719653110323`*^9, 
  3.7400720336651297`*^9}, {3.756486101091695*^9, 3.756486177830514*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"HotI", "[", 
   RowBox[{
   "T1_", ",", "T2_", ",", "w_", ",", "l_", ",", " ", "d_", ",", "b1_", ",", 
    "b2_", ",", " ", "a1_", ",", " ", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", "pp1", "]"}], "^", "2"}], "*", 
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"elec", "[", 
         RowBox[{"x1", ",", "w"}], "]"}], ",", 
        RowBox[{"elec", "[", 
         RowBox[{"x1", ",", "w"}], "]"}]}], "]"}]}], " ", 
     "\[IndentingNewLine]", "+", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", "pp2", "]"}], "^", "2"}], "*", 
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"elec", "[", 
         RowBox[{"x2", ",", "w"}], "]"}], ",", 
        RowBox[{"elec", "[", 
         RowBox[{"x2", ",", "w"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
     "+", " ", 
     RowBox[{
      RowBox[{"Abs", "[", "pp1", "]"}], "*", 
      RowBox[{"Abs", "[", "pp2", "]"}], "*", "2", "*", 
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"elec", "[", 
         RowBox[{"x1", ",", "w"}], "]"}], ",", 
        RowBox[{"elec", "[", 
         RowBox[{"x2", ",", "w"}], "]"}]}], "]"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"ArcTan", "[", 
         RowBox[{
          RowBox[{"Re", "[", "pp1", "]"}], ",", 
          RowBox[{"Im", "[", "pp1", "]"}]}], "]"}], "-", 
        RowBox[{"ArcTan", "[", 
         RowBox[{
          RowBox[{"Re", "[", "pp2", "]"}], ",", 
          RowBox[{"Im", "[", "pp2", "]"}]}], "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", ")"}], "/.", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"l", " ", "+", 
        RowBox[{"d", "/", "2"}]}], ")"}]}], ",", 
     RowBox[{"x2", "\[Rule]", " ", 
      RowBox[{"(", 
       RowBox[{"l", "-", 
        RowBox[{"d", "/", "2"}]}], " ", ")"}]}], ",", "\[IndentingNewLine]", 
     " ", 
     RowBox[{"pp1", "\[Rule]", 
      RowBox[{"p1hotFoc", "[", 
       RowBox[{
       "w", ",", " ", "T1", ",", " ", "b1", ",", "T2", ",", "b2", ",", "d", 
        ",", " ", "a1", ",", " ", "a2"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"pp2", "->", 
      RowBox[{"p2hotFoc", "[", 
       RowBox[{
       "w", ",", " ", "T1", ",", " ", "b1", ",", "T2", ",", "b2", ",", "d", 
        ",", " ", "a1", ",", " ", "a2"}], "]"}]}]}], "\[IndentingNewLine]", 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.736705415046311*^9, 3.736705517644712*^9}, {
  3.736706138467186*^9, 3.736706148318769*^9}, {3.736706220422394*^9, 
  3.736706222312606*^9}, {3.736712148155088*^9, 3.736712162818819*^9}, {
  3.736712319111974*^9, 3.736712406516024*^9}, {3.736712676453968*^9, 
  3.736712680589192*^9}, {3.756486184591675*^9, 3.756486196234782*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ColdI", "[", 
   RowBox[{
   "T1_", ",", "T2_", ",", "w_", ",", "l_", ",", " ", "d_", ",", "b1_", ",", 
    "b2_", ",", " ", "a1_", ",", " ", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", "pp1", "]"}], "^", "2"}], "*", 
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"elec", "[", 
         RowBox[{"x1", ",", "w"}], "]"}], ",", 
        RowBox[{"elec", "[", 
         RowBox[{"x1", ",", "w"}], "]"}]}], "]"}]}], " ", 
     "\[IndentingNewLine]", "+", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", "pp2", "]"}], "^", "2"}], "*", 
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"elec", "[", 
         RowBox[{"x2", ",", "w"}], "]"}], ",", 
        RowBox[{"elec", "[", 
         RowBox[{"x2", ",", "w"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
     "+", " ", 
     RowBox[{
      RowBox[{"Abs", "[", "pp1", "]"}], "*", 
      RowBox[{"Abs", "[", "pp2", "]"}], "*", "2", "*", 
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"elec", "[", 
         RowBox[{"x1", ",", "w"}], "]"}], ",", 
        RowBox[{"elec", "[", 
         RowBox[{"x2", ",", "w"}], "]"}]}], "]"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"ArcTan", "[", 
         RowBox[{
          RowBox[{"Re", "[", "pp1", "]"}], ",", 
          RowBox[{"Im", "[", "pp1", "]"}]}], "]"}], "-", 
        RowBox[{"ArcTan", "[", 
         RowBox[{
          RowBox[{"Re", "[", "pp2", "]"}], ",", 
          RowBox[{"Im", "[", "pp2", "]"}]}], "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", ")"}], "/.", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"l", " ", "+", 
        RowBox[{"d", "/", "2"}]}], ")"}]}], ",", 
     RowBox[{"x2", "\[Rule]", " ", 
      RowBox[{"(", 
       RowBox[{"l", "-", 
        RowBox[{"d", "/", "2"}]}], " ", ")"}]}], ",", "\[IndentingNewLine]", 
     " ", 
     RowBox[{"pp1", "\[Rule]", 
      RowBox[{"p1coldFoc", "[", 
       RowBox[{
       "w", ",", " ", "T1", ",", " ", "b1", ",", "T2", ",", "b2", ",", "d", 
        ",", " ", "a1", ",", " ", "a2"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"pp2", "->", 
      RowBox[{"p2coldFoc", "[", 
       RowBox[{
       "w", ",", " ", "T1", ",", " ", "b1", ",", "T2", ",", "b2", ",", "d", 
        ",", " ", "a1", ",", " ", "a2"}], "]"}]}]}], "\[IndentingNewLine]", 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.736705510492494*^9, 3.7367055288743343`*^9}, {
   3.736706226853243*^9, 3.7367062297088957`*^9}, {3.7367062671085777`*^9, 
   3.736706279740679*^9}, 3.736712424730089*^9, {3.736712669647901*^9, 
   3.7367126724675713`*^9}, {3.756486199334569*^9, 3.756486212598297*^9}}],

Cell["each dipole individually...", "Text",
 CellChangeTimes->{{3.7400726003711567`*^9, 3.740072607042835*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ColdI", "[", 
  RowBox[{
  "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.756486533274025*^9, 3.756486538777712*^9}}],

Cell[BoxData["1.817846170152559`*^35"], "Output",
 CellChangeTimes->{3.756486539094336*^9, 3.756486625755066*^9, 
  3.7564889830107403`*^9, 3.756505546665358*^9, 3.756505678238852*^9, 
  3.7569326987409983`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"HotI1", "[", 
   RowBox[{
   "T1_", ",", "T2_", ",", "w_", ",", "l_", ",", " ", "d_", ",", "b1_", ",", 
    "b2_", ",", " ", "a1_", ",", " ", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", "pp1", "]"}], "^", "2"}], "*", 
     RowBox[{"Dot", "[", 
      RowBox[{
       RowBox[{"elec", "[", 
        RowBox[{"x1", ",", "w"}], "]"}], ",", 
       RowBox[{"elec", "[", 
        RowBox[{"x1", ",", "w"}], "]"}]}], "]"}]}], " ", 
    "\[IndentingNewLine]", ")"}], "/.", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"l", " ", "+", 
        RowBox[{"d", "/", "2"}]}], ")"}]}], ",", 
     RowBox[{"x2", "\[Rule]", " ", 
      RowBox[{"(", 
       RowBox[{"l", "-", 
        RowBox[{"d", "/", "2"}]}], " ", ")"}]}], ",", "\[IndentingNewLine]", 
     " ", 
     RowBox[{"pp1", "\[Rule]", 
      RowBox[{"p1hotFoc", "[", 
       RowBox[{
       "w", ",", " ", "T1", ",", " ", "b1", ",", "T2", ",", "b2", ",", "d", 
        ",", " ", "a1", ",", " ", "a2"}], "]"}]}]}], "\[IndentingNewLine]", 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HotI2", "[", 
   RowBox[{
   "T1_", ",", "T2_", ",", "w_", ",", "l_", ",", " ", "d_", ",", "b1_", ",", 
    "b2_", ",", " ", "a1_", ",", " ", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", "pp2", "]"}], "^", "2"}], "*", 
     RowBox[{"Dot", "[", 
      RowBox[{
       RowBox[{"elec", "[", 
        RowBox[{"x2", ",", "w"}], "]"}], ",", 
       RowBox[{"elec", "[", 
        RowBox[{"x2", ",", "w"}], "]"}]}], "]"}]}], " ", 
    "\[IndentingNewLine]", ")"}], "/.", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"l", " ", "+", 
        RowBox[{"d", "/", "2"}]}], ")"}]}], ",", 
     RowBox[{"x2", "\[Rule]", " ", 
      RowBox[{"(", 
       RowBox[{"l", "-", 
        RowBox[{"d", "/", "2"}]}], " ", ")"}]}], ",", "\[IndentingNewLine]", 
     " ", 
     RowBox[{"pp2", "\[Rule]", 
      RowBox[{"p2hotFoc", "[", 
       RowBox[{
       "w", ",", " ", "T1", ",", " ", "b1", ",", "T2", ",", "b2", ",", "d", 
        ",", " ", "a1", ",", " ", "a2"}], "]"}]}]}], "\[IndentingNewLine]", 
    "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.7400725745807877`*^9, 3.740072651634392*^9}, {
  3.740073052939773*^9, 3.740073054470743*^9}, {3.756486219229323*^9, 
  3.756486225075416*^9}, {3.756486259038176*^9, 3.756486260881546*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ColdI1", "[", 
   RowBox[{
   "T1_", ",", "T2_", ",", "w_", ",", "l_", ",", " ", "d_", ",", "b1_", ",", 
    "b2_", ",", " ", "a1_", ",", " ", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", "pp1", "]"}], "^", "2"}], "*", 
     RowBox[{"Dot", "[", 
      RowBox[{
       RowBox[{"elec", "[", 
        RowBox[{"x1", ",", "w"}], "]"}], ",", 
       RowBox[{"elec", "[", 
        RowBox[{"x1", ",", "w"}], "]"}]}], "]"}]}], " ", 
    "\[IndentingNewLine]", ")"}], "/.", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"l", " ", "+", 
        RowBox[{"d", "/", "2"}]}], ")"}]}], ",", 
     RowBox[{"x2", "\[Rule]", " ", 
      RowBox[{"(", 
       RowBox[{"l", "-", 
        RowBox[{"d", "/", "2"}]}], " ", ")"}]}], ",", "\[IndentingNewLine]", 
     " ", 
     RowBox[{"pp1", "\[Rule]", 
      RowBox[{"p1coldFoc", "[", 
       RowBox[{
       "w", ",", " ", "T1", ",", " ", "b1", ",", "T2", ",", "b2", ",", "d", 
        ",", " ", "a1", ",", " ", "a2"}], "]"}]}]}], "\[IndentingNewLine]", 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ColdI2", "[", 
   RowBox[{
   "T1_", ",", "T2_", ",", "w_", ",", "l_", ",", " ", "d_", ",", "b1_", ",", 
    "b2_", ",", " ", "a1_", ",", " ", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", "pp2", "]"}], "^", "2"}], "*", 
     RowBox[{"Dot", "[", 
      RowBox[{
       RowBox[{"elec", "[", 
        RowBox[{"x2", ",", "w"}], "]"}], ",", 
       RowBox[{"elec", "[", 
        RowBox[{"x2", ",", "w"}], "]"}]}], "]"}]}], " ", 
    "\[IndentingNewLine]", ")"}], "/.", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"l", " ", "+", 
        RowBox[{"d", "/", "2"}]}], ")"}]}], ",", 
     RowBox[{"x2", "\[Rule]", " ", 
      RowBox[{"(", 
       RowBox[{"l", "-", 
        RowBox[{"d", "/", "2"}]}], " ", ")"}]}], ",", "\[IndentingNewLine]", 
     " ", 
     RowBox[{"pp2", "\[Rule]", 
      RowBox[{"p2coldFoc", "[", 
       RowBox[{
       "w", ",", " ", "T1", ",", " ", "b1", ",", "T2", ",", "b2", ",", "d", 
        ",", " ", "a1", ",", " ", "a2"}], "]"}]}]}], "\[IndentingNewLine]", 
    "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.7400726605116863`*^9, 3.740072678004038*^9}, {
  3.740073060915346*^9, 3.740073062093423*^9}, {3.75648622696425*^9, 
  3.756486228495802*^9}, {3.7564862627437353`*^9, 3.756486264591855*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"diffFocPTI", "[", 
   RowBox[{
   "T1_", ",", "T2_", ",", "w_", ",", "l_", ",", " ", "d_", ",", "b1_", ",", 
    "b2_", ",", " ", "a1_", ",", " ", "a2_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HotI", "[", 
     RowBox[{
     "T1", ",", "T2", ",", "w", ",", "l", ",", " ", "d", ",", "b1", ",", "b2",
       ",", " ", "a1", ",", " ", "a2"}], "]"}], "-", 
    RowBox[{"ColdI", "[", 
     RowBox[{
     "T1", ",", "T2", ",", "w", ",", "l", ",", " ", "d", ",", "b1", ",", "b2",
       ",", " ", "a1", ",", " ", "a2"}], "]"}]}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.736705543188778*^9, 3.736705587703088*^9}, {
   3.756486230589799*^9, 3.756486233705421*^9}, 3.7564862666934767`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"diffFocPTI1", "[", 
   RowBox[{
   "T1_", ",", "T2_", ",", "w_", ",", "l_", ",", " ", "d_", ",", "b1_", ",", 
    "b2_", ",", " ", "a1_", ",", " ", "a2_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HotI1", "[", 
     RowBox[{
     "T1", ",", "T2", ",", "w", ",", "l", ",", " ", "d", ",", "b1", ",", "b2",
       ",", " ", "a1", ",", " ", "a2"}], "]"}], "-", 
    RowBox[{"ColdI1", "[", 
     RowBox[{
     "T1", ",", "T2", ",", "w", ",", "l", ",", " ", "d", ",", "b1", ",", "b2",
       ",", " ", "a1", ",", " ", "a2"}], "]"}]}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.740072705882728*^9, 3.740072717038612*^9}, {
   3.756486235563716*^9, 3.756486236917614*^9}, 3.756486270057283*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"diffFocPTI2", "[", 
   RowBox[{
   "T1_", ",", "T2_", ",", "w_", ",", "l_", ",", " ", "d_", ",", "b1_", ",", 
    "b2_", ",", " ", "a1_", ",", " ", "a2_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HotI2", "[", 
     RowBox[{
     "T1", ",", "T2", ",", "w", ",", "l", ",", " ", "d", ",", "b1", ",", "b2",
       ",", " ", "a1", ",", " ", "a2"}], "]"}], "-", 
    RowBox[{"ColdI2", "[", 
     RowBox[{
     "T1", ",", "T2", ",", "w", ",", "l", ",", " ", "d", ",", "b1", ",", "b2",
       ",", " ", "a1", ",", " ", "a2"}], "]"}]}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.740072722187743*^9, 3.7400727257138023`*^9}, {
   3.756486238781201*^9, 3.756486239627226*^9}, 3.7564862709994373`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PlotDiffFocPTI", "[", 
    RowBox[{
    "T1_", ",", "T2_", ",", "w_", ",", "d_", ",", "b1_", ",", "b2_", ",", " ",
      "a1_", ",", " ", "a2_"}], "]"}], ":=", 
   RowBox[{"Plot", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"diffFocPTI", "[", 
      RowBox[{"T1", ",", "T2", ",", "w", ",", 
       RowBox[{"nm", "[", "l", "]"}], ",", " ", "d", ",", "b1", ",", "b2", 
       ",", " ", "a1", ",", " ", "a2"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", 
       RowBox[{
        RowBox[{"-", "sensorWidth"}], "/", "2"}], ",", 
       RowBox[{"sensorWidth", "/", "2"}]}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
    RowBox[{"(*", 
     RowBox[{",", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<x [nm]\>\"", ",", 
         "\"\<PT Intensity [erg/s*\!\(\*SuperscriptBox[\(cm\), \
\(2\)]\)]\>\""}], "}"}]}]}], "*)"}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7367062967360363`*^9, 3.7367063679982653`*^9}, {
   3.7367064505060587`*^9, 3.7367064694436502`*^9}, {3.7400723656579733`*^9, 
   3.740072371967111*^9}, 3.740072943240457*^9, {3.7400731545967283`*^9, 
   3.740073172795731*^9}, {3.740849795462892*^9, 3.740849876652938*^9}, 
   3.756486242184284*^9, 3.756486275369617*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlotDiffFocPTI1", "[", 
   RowBox[{
   "T1_", ",", "T2_", ",", "w_", ",", "d_", ",", "b1_", ",", "b2_", ",", " ", 
    "a1_", ",", " ", "a2_"}], "]"}], ":=", 
  RowBox[{"Plot", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diffFocPTI1", "[", 
     RowBox[{"T1", ",", "T2", ",", "w", ",", 
      RowBox[{"nm", "[", "l", "]"}], ",", " ", "d", ",", "b1", ",", "b2", ",",
       " ", "a1", ",", " ", "a2"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"l", ",", 
      RowBox[{
       RowBox[{"-", "sensorWidth"}], "/", "2"}], ",", 
      RowBox[{"sensorWidth", "/", "2"}]}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", "Green"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7400729518426523`*^9, 3.740072953071434*^9}, {
   3.740073157730504*^9, 3.7400731817030888`*^9}, 3.756486247615714*^9, 
   3.756486281071373*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlotDiffFocPTI2", "[", 
   RowBox[{
   "T1_", ",", "T2_", ",", "w_", ",", "d_", ",", "b1_", ",", "b2_", ",", " ", 
    "a1_", ",", " ", "a2_"}], "]"}], ":=", 
  RowBox[{"Plot", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diffFocPTI2", "[", 
     RowBox[{"T1", ",", "T2", ",", "w", ",", 
      RowBox[{"nm", "[", "l", "]"}], ",", " ", "d", ",", "b1", ",", "b2", ",",
       " ", "a1", ",", " ", "a2"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"l", ",", 
      RowBox[{
       RowBox[{"-", "sensorWidth"}], "/", "2"}], ",", 
      RowBox[{"sensorWidth", "/", "2"}]}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", "Gray"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.740072958893318*^9, 3.740072961361444*^9}, {
   3.7400731855850897`*^9, 3.740073185806519*^9}, 3.7564862485879087`*^9, 
   3.7564862852117147`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"maniPlot", "=", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PlotDiffFocPTI", "[", 
       RowBox[{"T1", ",", "T2", ",", 
        RowBox[{"w", "/", "hbar"}], ",", 
        RowBox[{"nm", "[", 
         RowBox[{"\[Delta]d", "+", "a1", "+", "a2"}], "]"}], ",", 
        RowBox[{"nm", "[", 
         RowBox[{"\[Delta]b1", "+", "a1"}], "]"}], ",", 
        RowBox[{"nm", "[", 
         RowBox[{"\[Delta]b2", "+", "a2"}], "]"}], ",", " ", 
        RowBox[{"nm", "[", "a1", "]"}], ",", " ", 
        RowBox[{"nm", "[", "a2", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotDiffFocPTI1", "[", 
       RowBox[{"T1", ",", "T2", ",", 
        RowBox[{"w", "/", "hbar"}], ",", 
        RowBox[{"nm", "[", 
         RowBox[{"\[Delta]d", "+", "a1", "+", "a2"}], "]"}], ",", 
        RowBox[{"nm", "[", 
         RowBox[{"\[Delta]b1", "+", "a1"}], "]"}], ",", 
        RowBox[{"nm", "[", 
         RowBox[{"\[Delta]b2", "+", "a2"}], "]"}], ",", " ", 
        RowBox[{"nm", "[", "a1", "]"}], ",", " ", 
        RowBox[{"nm", "[", "a2", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotDiffFocPTI2", "[", 
       RowBox[{"T1", ",", "T2", ",", 
        RowBox[{"w", "/", "hbar"}], ",", 
        RowBox[{"nm", "[", 
         RowBox[{"\[Delta]d", "+", "a1", "+", "a2"}], "]"}], ",", 
        RowBox[{"nm", "[", 
         RowBox[{"\[Delta]b1", "+", "a1"}], "]"}], ",", 
        RowBox[{"nm", "[", 
         RowBox[{"\[Delta]b2", "+", "a2"}], "]"}], ",", " ", 
        RowBox[{"nm", "[", "a1", "]"}], ",", " ", 
        RowBox[{"nm", "[", "a2", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Green", ",", 
          RowBox[{"PointSize", "[", ".01", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[Delta]d"}], "/", "2"}], "-", "a1"}], ",", 
             "0"}], "}"}], "]"}], ",", "\[IndentingNewLine]", "Gray", ",", 
          RowBox[{"PointSize", "[", ".01", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Delta]d", "/", "2"}], "+", "a2"}], ",", "0"}], "}"}],
            "]"}]}], "}"}], ",", 
        RowBox[{"Axes", "\[Rule]", "True"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<x [nm]\>\"", ",", "\"\<Photothermal Power [erg/s]\>\""}], 
          "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<image\>\"", ",", 
         RowBox[{"FontSize", "\[Rule]", "18"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T1", ",", "15"}], "}"}], ",", "1", ",", "200"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T2", ",", "12"}], "}"}], ",", "1", ",", "200"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Delta]d", ",", "10"}], "}"}], ",", "10", ",", "100"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Delta]b1", ",", "5"}], "}"}], ",", "1", ",", "100"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Delta]b2", ",", "5"}], "}"}], ",", "1", ",", "100"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a1", ",", "37"}], "}"}], ",", "10", ",", "100"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a2", ",", "44"}], "}"}], ",", "10", ",", "100"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"w", ",", "2.48"}], "}"}], ",", "1", ",", "6"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.73670561120142*^9, 3.736705611646894*^9}, {
   3.736706237812223*^9, 3.736706245748089*^9}, {3.736706374204657*^9, 
   3.7367063772527514`*^9}, 3.736706459593525*^9, {3.740072971518062*^9, 
   3.740072975200841*^9}, {3.740075639594331*^9, 3.740075653158327*^9}, {
   3.740076124690907*^9, 3.740076132445113*^9}, {3.7408444203795547`*^9, 
   3.7408445089522047`*^9}, {3.740844556058223*^9, 3.740844562185794*^9}, {
   3.7408446113101273`*^9, 3.740844613797328*^9}, {3.740844751776713*^9, 
   3.740844784093292*^9}, {3.756486292155657*^9, 3.756486317838505*^9}, {
   3.756486475690089*^9, 3.756486499949388*^9}, {3.756487466079479*^9, 
   3.756487475440002*^9}, {3.756563928219853*^9, 3.756564008970049*^9}, {
   3.756564760402471*^9, 3.756564811411005*^9}, {3.756564850901387*^9, 
   3.756564879584256*^9}, {3.7565649937703333`*^9, 3.7565649986843653`*^9}, {
   3.7565652708037777`*^9, 3.756565301169158*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a1$$ = 37, $CellContext`a2$$ = 
    44, $CellContext`T1$$ = 15, $CellContext`T2$$ = 12, $CellContext`w$$ = 
    2.48, $CellContext`\[Delta]b1$$ = 5, $CellContext`\[Delta]b2$$ = 
    5, $CellContext`\[Delta]d$$ = 10, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`T1$$], 15}, 1, 200}, {{
       Hold[$CellContext`T2$$], 12}, 1, 200}, {{
       Hold[$CellContext`\[Delta]d$$], 10}, 10, 100}, {{
       Hold[$CellContext`\[Delta]b1$$], 5}, 1, 100}, {{
       Hold[$CellContext`\[Delta]b2$$], 5}, 1, 100}, {{
       Hold[$CellContext`a1$$], 37}, 10, 100}, {{
       Hold[$CellContext`a2$$], 44}, 10, 100}, {{
       Hold[$CellContext`w$$], 2.48}, 1, 6}}, Typeset`size$$ = {
    450., {149., 156.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`T1$2092$$ = 
    0, $CellContext`T2$2093$$ = 0, $CellContext`\[Delta]d$2094$$ = 
    0, $CellContext`\[Delta]b1$2095$$ = 0, $CellContext`\[Delta]b2$2096$$ = 
    0, $CellContext`a1$2097$$ = 0, $CellContext`a2$2098$$ = 
    0, $CellContext`w$2099$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a1$$ = 37, $CellContext`a2$$ = 
        44, $CellContext`T1$$ = 15, $CellContext`T2$$ = 12, $CellContext`w$$ = 
        2.48, $CellContext`\[Delta]b1$$ = 5, $CellContext`\[Delta]b2$$ = 
        5, $CellContext`\[Delta]d$$ = 10}, "ControllerVariables" :> {
        Hold[$CellContext`T1$$, $CellContext`T1$2092$$, 0], 
        Hold[$CellContext`T2$$, $CellContext`T2$2093$$, 0], 
        Hold[$CellContext`\[Delta]d$$, $CellContext`\[Delta]d$2094$$, 0], 
        Hold[$CellContext`\[Delta]b1$$, $CellContext`\[Delta]b1$2095$$, 0], 
        Hold[$CellContext`\[Delta]b2$$, $CellContext`\[Delta]b2$2096$$, 0], 
        Hold[$CellContext`a1$$, $CellContext`a1$2097$$, 0], 
        Hold[$CellContext`a2$$, $CellContext`a2$2098$$, 0], 
        Hold[$CellContext`w$$, $CellContext`w$2099$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ($CellContext`maniPlot = Show[
         $CellContext`PlotDiffFocPTI[$CellContext`T1$$, $CellContext`T2$$, \
$CellContext`w$$/$CellContext`hbar, 
          $CellContext`nm[$CellContext`\[Delta]d$$ + $CellContext`a1$$ + \
$CellContext`a2$$], 
          $CellContext`nm[$CellContext`\[Delta]b1$$ + $CellContext`a1$$], 
          $CellContext`nm[$CellContext`\[Delta]b2$$ + $CellContext`a2$$], 
          $CellContext`nm[$CellContext`a1$$], 
          $CellContext`nm[$CellContext`a2$$]], 
         $CellContext`PlotDiffFocPTI1[$CellContext`T1$$, $CellContext`T2$$, \
$CellContext`w$$/$CellContext`hbar, 
          $CellContext`nm[$CellContext`\[Delta]d$$ + $CellContext`a1$$ + \
$CellContext`a2$$], 
          $CellContext`nm[$CellContext`\[Delta]b1$$ + $CellContext`a1$$], 
          $CellContext`nm[$CellContext`\[Delta]b2$$ + $CellContext`a2$$], 
          $CellContext`nm[$CellContext`a1$$], 
          $CellContext`nm[$CellContext`a2$$]], 
         $CellContext`PlotDiffFocPTI2[$CellContext`T1$$, $CellContext`T2$$, \
$CellContext`w$$/$CellContext`hbar, 
          $CellContext`nm[$CellContext`\[Delta]d$$ + $CellContext`a1$$ + \
$CellContext`a2$$], 
          $CellContext`nm[$CellContext`\[Delta]b1$$ + $CellContext`a1$$], 
          $CellContext`nm[$CellContext`\[Delta]b2$$ + $CellContext`a2$$], 
          $CellContext`nm[$CellContext`a1$$], 
          $CellContext`nm[$CellContext`a2$$]], 
         Graphics[{Green, 
           PointSize[0.01], 
           Point[{(-$CellContext`\[Delta]d$$)/2 - $CellContext`a1$$, 0}], 
           Gray, 
           PointSize[0.01], 
           Point[{$CellContext`\[Delta]d$$/2 + $CellContext`a2$$, 0}]}, Axes -> 
          True, AxesLabel -> {"x [nm]", "Photothermal Power [erg/s]"}], 
         PlotLabel -> Style["image", FontSize -> 18]]), 
      "Specifications" :> {{{$CellContext`T1$$, 15}, 1, 
         200}, {{$CellContext`T2$$, 12}, 1, 
         200}, {{$CellContext`\[Delta]d$$, 10}, 10, 
         100}, {{$CellContext`\[Delta]b1$$, 5}, 1, 
         100}, {{$CellContext`\[Delta]b2$$, 5}, 1, 
         100}, {{$CellContext`a1$$, 37}, 10, 100}, {{$CellContext`a2$$, 44}, 
         10, 100}, {{$CellContext`w$$, 2.48}, 1, 6}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{803., {185., 192.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.740844768952284*^9, 3.7408447956897984`*^9}, {
   3.7408480229408693`*^9, 3.740848052850687*^9}, {3.740849846056487*^9, 
   3.740849902373003*^9}, 3.741358786195141*^9, 3.756481298241354*^9, 
   3.756481586038468*^9, 3.7564863369202747`*^9, 3.756486501091525*^9, 
   3.756486625913856*^9, 3.756488983213812*^9, 3.7565055472038527`*^9, 
   3.756505678376172*^9, 3.756563890894689*^9, {3.7565639688463907`*^9, 
   3.756563983731901*^9}, 3.756564019646834*^9, 3.756564815952783*^9, 
   3.756564885311439*^9, 3.7565650002380867`*^9, 3.7565653025770397`*^9, 
   3.756932698988922*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"DiffPowerScatt", "[", 
        RowBox[{
         RowBox[{"w", "/", "hbar"}], ",", "T1", ",", 
         RowBox[{"nm", "[", 
          RowBox[{"\[Delta]b1", "+", "a1"}], "]"}], ",", "T2", ",", 
         RowBox[{"nm", "[", 
          RowBox[{"\[Delta]b2", "+", "a2"}], "]"}], ",", 
         RowBox[{"nm", "[", 
          RowBox[{"\[Delta]d", "+", "a1", "+", "a2"}], "]"}], ",", 
         RowBox[{"nm", "[", "x0", "]"}], ",", 
         RowBox[{"nm", "[", "a1", "]"}], ",", 
         RowBox[{"nm", "[", "a2", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x0", ",", 
         RowBox[{
          RowBox[{"-", "sensorWidth"}], "/", "2"}], ",", 
         RowBox[{"sensorWidth", "/", "2"}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"DiffPowerScatt1", "[", 
        RowBox[{
         RowBox[{"w", "/", "hbar"}], ",", "T1", ",", 
         RowBox[{"nm", "[", 
          RowBox[{"\[Delta]b1", "+", "a1"}], "]"}], ",", "T2", ",", 
         RowBox[{"nm", "[", 
          RowBox[{"\[Delta]b2", "+", "a2"}], "]"}], ",", 
         RowBox[{"nm", "[", 
          RowBox[{"\[Delta]d", "+", "a1", "+", "a2"}], "]"}], ",", 
         RowBox[{"nm", "[", "x0", "]"}], ",", 
         RowBox[{"nm", "[", "a1", "]"}], ",", 
         RowBox[{"nm", "[", "a2", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x0", ",", 
         RowBox[{
          RowBox[{"-", "sensorWidth"}], "/", "2"}], ",", 
         RowBox[{"sensorWidth", "/", "2"}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
       RowBox[{"PlotStyle", "\[Rule]", "Green"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"DiffPowerScatt2", "[", 
        RowBox[{
         RowBox[{"w", "/", "hbar"}], ",", "T1", ",", 
         RowBox[{"nm", "[", 
          RowBox[{"\[Delta]b1", "+", "a1"}], "]"}], ",", "T2", ",", 
         RowBox[{"nm", "[", 
          RowBox[{"\[Delta]b2", "+", "a2"}], "]"}], ",", 
         RowBox[{"nm", "[", 
          RowBox[{"\[Delta]d", "+", "a1", "+", "a2"}], "]"}], ",", 
         RowBox[{"nm", "[", "x0", "]"}], ",", 
         RowBox[{"nm", "[", "a1", "]"}], ",", 
         RowBox[{"nm", "[", "a2", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x0", ",", 
         RowBox[{
          RowBox[{"-", "sensorWidth"}], "/", "2"}], ",", 
         RowBox[{"sensorWidth", "/", "2"}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Gray"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Green", ",", 
         RowBox[{"PointSize", "[", ".01", "]"}], ",", 
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[Delta]d"}], "/", "2"}], "-", "a1"}], ",", "0"}],
            "}"}], "]"}], ",", "\[IndentingNewLine]", "Gray", ",", 
         RowBox[{"PointSize", "[", ".01", "]"}], ",", 
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Delta]d", "/", "2"}], "+", "a2"}], ",", "0"}], "}"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}]}], "\[IndentingNewLine]", "\t", 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<scan\>\"", ",", 
        RowBox[{"FontSize", "\[Rule]", "18"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T1", ",", "15"}], "}"}], ",", "1", ",", "200"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T2", ",", "12"}], "}"}], ",", "1", ",", "200"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Delta]d", ",", "10"}], "}"}], ",", "10", ",", 
     RowBox[{"1240", "/", "2.48"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Delta]b1", ",", "5"}], "}"}], ",", "1", ",", "100"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Delta]b2", ",", "5"}], "}"}], ",", "1", ",", "100"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a1", ",", "37"}], "}"}], ",", "10", ",", "100"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a2", ",", "44"}], "}"}], ",", "10", ",", "100"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"w", ",", "2.48"}], "}"}], ",", "1", ",", "6"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.740075973494215*^9, 3.740075994925561*^9}, {
   3.74007606271894*^9, 3.7400761133553333`*^9}, {3.756486660307789*^9, 
   3.756486670898929*^9}, {3.7565638095237226`*^9, 3.756563856230604*^9}, 
   3.7565639085504017`*^9, {3.756564013577194*^9, 3.756564014760182*^9}, {
   3.7565649050753727`*^9, 3.756564940500061*^9}, {3.7565649732769613`*^9, 
   3.756564982295787*^9}, {3.7565650260929537`*^9, 3.756565035097147*^9}, {
   3.7565675806714897`*^9, 3.756567595809835*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a1$$ = 37, $CellContext`a2$$ = 
    44, $CellContext`T1$$ = 15, $CellContext`T2$$ = 12, $CellContext`w$$ = 
    2.48, $CellContext`\[Delta]b1$$ = 5, $CellContext`\[Delta]b2$$ = 
    5, $CellContext`\[Delta]d$$ = 10, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`T1$$], 15}, 1, 200}, {{
       Hold[$CellContext`T2$$], 12}, 1, 200}, {{
       Hold[$CellContext`\[Delta]d$$], 10}, 10, 500.00000000000006`}, {{
       Hold[$CellContext`\[Delta]b1$$], 5}, 1, 100}, {{
       Hold[$CellContext`\[Delta]b2$$], 5}, 1, 100}, {{
       Hold[$CellContext`a1$$], 37}, 10, 100}, {{
       Hold[$CellContext`a2$$], 44}, 10, 100}, {{
       Hold[$CellContext`w$$], 2.48}, 1, 6}}, Typeset`size$$ = {
    450., {147., 154.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`T1$2270$$ = 
    0, $CellContext`T2$2271$$ = 0, $CellContext`\[Delta]d$2272$$ = 
    0, $CellContext`\[Delta]b1$2273$$ = 0, $CellContext`\[Delta]b2$2274$$ = 
    0, $CellContext`a1$2275$$ = 0, $CellContext`a2$2276$$ = 
    0, $CellContext`w$2277$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a1$$ = 37, $CellContext`a2$$ = 
        44, $CellContext`T1$$ = 15, $CellContext`T2$$ = 12, $CellContext`w$$ = 
        2.48, $CellContext`\[Delta]b1$$ = 5, $CellContext`\[Delta]b2$$ = 
        5, $CellContext`\[Delta]d$$ = 10}, "ControllerVariables" :> {
        Hold[$CellContext`T1$$, $CellContext`T1$2270$$, 0], 
        Hold[$CellContext`T2$$, $CellContext`T2$2271$$, 0], 
        Hold[$CellContext`\[Delta]d$$, $CellContext`\[Delta]d$2272$$, 0], 
        Hold[$CellContext`\[Delta]b1$$, $CellContext`\[Delta]b1$2273$$, 0], 
        Hold[$CellContext`\[Delta]b2$$, $CellContext`\[Delta]b2$2274$$, 0], 
        Hold[$CellContext`a1$$, $CellContext`a1$2275$$, 0], 
        Hold[$CellContext`a2$$, $CellContext`a2$2276$$, 0], 
        Hold[$CellContext`w$$, $CellContext`w$2277$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Show[
        Plot[
         $CellContext`DiffPowerScatt[$CellContext`w$$/$CellContext`hbar, \
$CellContext`T1$$, 
          $CellContext`nm[$CellContext`\[Delta]b1$$ + $CellContext`a1$$], \
$CellContext`T2$$, 
          $CellContext`nm[$CellContext`\[Delta]b2$$ + $CellContext`a2$$], 
          $CellContext`nm[$CellContext`\[Delta]d$$ + $CellContext`a1$$ + \
$CellContext`a2$$], 
          $CellContext`nm[$CellContext`x0], 
          $CellContext`nm[$CellContext`a1$$], 
          $CellContext`nm[$CellContext`a2$$]], {$CellContext`x0, \
(-$CellContext`sensorWidth)/2, $CellContext`sensorWidth/2}, PlotRange -> All], 
        Plot[
         $CellContext`DiffPowerScatt1[$CellContext`w$$/$CellContext`hbar, \
$CellContext`T1$$, 
          $CellContext`nm[$CellContext`\[Delta]b1$$ + $CellContext`a1$$], \
$CellContext`T2$$, 
          $CellContext`nm[$CellContext`\[Delta]b2$$ + $CellContext`a2$$], 
          $CellContext`nm[$CellContext`\[Delta]d$$ + $CellContext`a1$$ + \
$CellContext`a2$$], 
          $CellContext`nm[$CellContext`x0], 
          $CellContext`nm[$CellContext`a1$$], 
          $CellContext`nm[$CellContext`a2$$]], {$CellContext`x0, \
(-$CellContext`sensorWidth)/2, $CellContext`sensorWidth/2}, PlotRange -> All, 
         PlotStyle -> Green], 
        Plot[
         $CellContext`DiffPowerScatt2[$CellContext`w$$/$CellContext`hbar, \
$CellContext`T1$$, 
          $CellContext`nm[$CellContext`\[Delta]b1$$ + $CellContext`a1$$], \
$CellContext`T2$$, 
          $CellContext`nm[$CellContext`\[Delta]b2$$ + $CellContext`a2$$], 
          $CellContext`nm[$CellContext`\[Delta]d$$ + $CellContext`a1$$ + \
$CellContext`a2$$], 
          $CellContext`nm[$CellContext`x0], 
          $CellContext`nm[$CellContext`a1$$], 
          $CellContext`nm[$CellContext`a2$$]], {$CellContext`x0, \
(-$CellContext`sensorWidth)/2, $CellContext`sensorWidth/2}, PlotRange -> All, 
         PlotStyle -> Gray], 
        Graphics[{Green, 
          PointSize[0.01], 
          Point[{(-$CellContext`\[Delta]d$$)/2 - $CellContext`a1$$, 0}], Gray, 
          PointSize[0.01], 
          Point[{$CellContext`\[Delta]d$$/2 + $CellContext`a2$$, 0}]}, Axes -> 
         True], PlotLabel -> Style["scan", FontSize -> 18]], 
      "Specifications" :> {{{$CellContext`T1$$, 15}, 1, 
         200}, {{$CellContext`T2$$, 12}, 1, 
         200}, {{$CellContext`\[Delta]d$$, 10}, 10, 
         500.00000000000006`}, {{$CellContext`\[Delta]b1$$, 5}, 1, 
         100}, {{$CellContext`\[Delta]b2$$, 5}, 1, 
         100}, {{$CellContext`a1$$, 37}, 10, 100}, {{$CellContext`a2$$, 44}, 
         10, 100}, {{$CellContext`w$$, 2.48}, 1, 6}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{803., {183., 190.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.740075893674712*^9, 3.740076115267249*^9, 3.740506402279196*^9, 
   3.740602672483656*^9, 3.7406044960871983`*^9, 3.740841766573255*^9, {
   3.740848024941205*^9, 3.740848054674889*^9}, 3.7408499033511343`*^9, 
   3.741358787164727*^9, 3.756481299417205*^9, 3.756481587097698*^9, 
   3.756486626792478*^9, 3.75648667283635*^9, 3.75648898404351*^9, 
   3.756505548165352*^9, 3.756505679574353*^9, 3.756563858318934*^9, 
   3.756563909275984*^9, 3.7565640187724857`*^9, {3.756564916177143*^9, 
   3.756564941844037*^9}, 3.756564983944858*^9, {3.756565032040307*^9, 
   3.756565041333519*^9}, 3.756567597208621*^9, 3.75673263179149*^9, 
   3.756932699922826*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Legended", "[", 
    RowBox[{
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"DiffPowerScatt", "[", 
          RowBox[{
           RowBox[{"w", "/", "hbar"}], ",", "T1", ",", 
           RowBox[{"nm", "[", 
            RowBox[{"\[Delta]b1", "+", "a1"}], "]"}], ",", "T2", ",", 
           RowBox[{"nm", "[", 
            RowBox[{"\[Delta]b2", "+", "a2"}], "]"}], ",", 
           RowBox[{"nm", "[", "d", "]"}], ",", 
           RowBox[{"nm", "[", "x0", "]"}], ",", 
           RowBox[{"nm", "[", "a1", "]"}], ",", 
           RowBox[{"nm", "[", "a2", "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x0", ",", 
           RowBox[{
            RowBox[{"-", "sensorWidth"}], "/", "2"}], ",", 
           RowBox[{"sensorWidth", "/", "2"}]}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{
           RowBox[{"ColorData", "[", "97", "]"}], "[", "2", "]"}]}]}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"PlotDiffFocPTI", "[", 
        RowBox[{"T1", ",", "T2", ",", 
         RowBox[{"w", "/", "hbar"}], ",", 
         RowBox[{"nm", "[", "d", "]"}], ",", 
         RowBox[{"nm", "[", 
          RowBox[{"\[Delta]b1", "+", "a1"}], "]"}], ",", 
         RowBox[{"nm", "[", 
          RowBox[{"\[Delta]b2", "+", "a2"}], "]"}], ",", 
         RowBox[{"nm", "[", "a1", "]"}], ",", 
         RowBox[{"nm", "[", "a2", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Gray", ",", 
           RowBox[{"PointSize", "[", ".01", "]"}], ",", 
           RowBox[{"Point", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"d", "/", "2"}], ",", "0"}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", "Green", ",", 
           RowBox[{"PointSize", "[", ".01", "]"}], ",", 
           RowBox[{"Point", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "d"}], "/", "2"}], ",", "0"}], "}"}], "]"}]}], 
          "}"}], ",", 
         RowBox[{"Axes", "\[Rule]", "True"}]}], "\[IndentingNewLine]", "\t", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<scan\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "18"}]}], "]"}]}], ","}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{"0", ",", "h"}], "}"}]}]}], 
      RowBox[{"(*", 
       RowBox[{",", "\[IndentingNewLine]", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<scan\>\"", ",", "\"\<image\>\""}], "}"}]}]}], "*)"}], 
      "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"LineLegend", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorData", "[", "97", "]"}], "[", "2", "]"}], ",", 
         RowBox[{
          RowBox[{"ColorData", "[", "97", "]"}], "[", "1", "]"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"\"\<scan\>\"", ",", " ", "\"\<image\>\""}], "}"}]}], "]"}]}],
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T1", ",", "150"}], "}"}], ",", "1", ",", "200"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T2", ",", "12"}], "}"}], ",", "1", ",", "200"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "90"}], "}"}], ",", "10", ",", 
     RowBox[{"1240", "/", "2.48"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Delta]b1", ",", "5"}], "}"}], ",", "1", ",", "100"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Delta]b2", ",", "5"}], "}"}], ",", "1", ",", "100"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a1", ",", "37"}], "}"}], ",", "10", ",", "100"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a2", ",", "44"}], "}"}], ",", "10", ",", "100"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"h", ",", "15"}], "}"}], ",", "10", ",", " ", "1000"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"w", ",", "1.24"}], "}"}], ",", "1", ",", "4"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.740076218874514*^9, 3.7400762548710527`*^9}, {
   3.740076490900461*^9, 3.740076554874716*^9}, {3.740076735713732*^9, 
   3.740076759197997*^9}, {3.740098923899413*^9, 3.740098942127953*^9}, {
   3.7400989756076393`*^9, 3.740098993036734*^9}, {3.740099195878145*^9, 
   3.740099197974022*^9}, {3.740099243321495*^9, 3.740099292641638*^9}, {
   3.740099446197706*^9, 3.740099449028081*^9}, {3.7400994816877213`*^9, 
   3.740099519734193*^9}, {3.7406043404488287`*^9, 3.74060435271487*^9}, {
   3.740605165298259*^9, 3.740605173149185*^9}, 3.7564816892041883`*^9, {
   3.756481807382711*^9, 3.756481825932663*^9}, {3.756486683330122*^9, 
   3.756486693639862*^9}, {3.756486883054509*^9, 3.75648691796484*^9}, {
   3.756487485772955*^9, 3.756487505939603*^9}, {3.756489041116996*^9, 
   3.756489047567276*^9}, {3.756489449782495*^9, 3.756489490145281*^9}, {
   3.7565047389017*^9, 3.75650481230274*^9}, {3.756504847106552*^9, 
   3.756504847221727*^9}, 3.756504927041276*^9, {3.756505180358448*^9, 
   3.7565051817379503`*^9}, {3.75650521341465*^9, 3.756505218826024*^9}, {
   3.756505295198319*^9, 3.756505337589994*^9}, {3.756505388819768*^9, 
   3.756505434523025*^9}, {3.756505518037527*^9, 3.756505519713848*^9}, {
   3.7565058738163223`*^9, 3.756505876564706*^9}, {3.7565060393734093`*^9, 
   3.756506046199985*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a1$$ = 37, $CellContext`a2$$ = 
    44, $CellContext`d$$ = 90, $CellContext`h$$ = 15, $CellContext`T1$$ = 
    150, $CellContext`T2$$ = 12, $CellContext`w$$ = 
    1.24, $CellContext`\[Delta]b1$$ = 5, $CellContext`\[Delta]b2$$ = 5, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`T1$$], 150}, 1, 200}, {{
       Hold[$CellContext`T2$$], 12}, 1, 200}, {{
       Hold[$CellContext`d$$], 90}, 10, 500.00000000000006`}, {{
       Hold[$CellContext`\[Delta]b1$$], 5}, 1, 100}, {{
       Hold[$CellContext`\[Delta]b2$$], 5}, 1, 100}, {{
       Hold[$CellContext`a1$$], 37}, 10, 100}, {{
       Hold[$CellContext`a2$$], 44}, 10, 100}, {{
       Hold[$CellContext`h$$], 15}, 10, 1000}, {{
       Hold[$CellContext`w$$], 1.24}, 1, 4}}, Typeset`size$$ = {
    550., {134., 141.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`T1$2446$$ = 
    0, $CellContext`T2$2447$$ = 0, $CellContext`d$2448$$ = 
    0, $CellContext`\[Delta]b1$2449$$ = 0, $CellContext`\[Delta]b2$2450$$ = 
    0, $CellContext`a1$2451$$ = 0, $CellContext`a2$2452$$ = 
    0, $CellContext`h$2453$$ = 0, $CellContext`w$2454$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a1$$ = 37, $CellContext`a2$$ = 
        44, $CellContext`d$$ = 90, $CellContext`h$$ = 15, $CellContext`T1$$ = 
        150, $CellContext`T2$$ = 12, $CellContext`w$$ = 
        1.24, $CellContext`\[Delta]b1$$ = 5, $CellContext`\[Delta]b2$$ = 5}, 
      "ControllerVariables" :> {
        Hold[$CellContext`T1$$, $CellContext`T1$2446$$, 0], 
        Hold[$CellContext`T2$$, $CellContext`T2$2447$$, 0], 
        Hold[$CellContext`d$$, $CellContext`d$2448$$, 0], 
        Hold[$CellContext`\[Delta]b1$$, $CellContext`\[Delta]b1$2449$$, 0], 
        Hold[$CellContext`\[Delta]b2$$, $CellContext`\[Delta]b2$2450$$, 0], 
        Hold[$CellContext`a1$$, $CellContext`a1$2451$$, 0], 
        Hold[$CellContext`a2$$, $CellContext`a2$2452$$, 0], 
        Hold[$CellContext`h$$, $CellContext`h$2453$$, 0], 
        Hold[$CellContext`w$$, $CellContext`w$2454$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Legended[
        Show[
         Plot[
          $CellContext`DiffPowerScatt[$CellContext`w$$/$CellContext`hbar, \
$CellContext`T1$$, 
           $CellContext`nm[$CellContext`\[Delta]b1$$ + $CellContext`a1$$], \
$CellContext`T2$$, 
           $CellContext`nm[$CellContext`\[Delta]b2$$ + $CellContext`a2$$], 
           $CellContext`nm[$CellContext`d$$], 
           $CellContext`nm[$CellContext`x0], 
           $CellContext`nm[$CellContext`a1$$], 
           $CellContext`nm[$CellContext`a2$$]], {$CellContext`x0, \
(-$CellContext`sensorWidth)/2, $CellContext`sensorWidth/2}, PlotRange -> All, 
          PlotStyle -> ColorData[97][2]], 
         $CellContext`PlotDiffFocPTI[$CellContext`T1$$, $CellContext`T2$$, \
$CellContext`w$$/$CellContext`hbar, 
          $CellContext`nm[$CellContext`d$$], 
          $CellContext`nm[$CellContext`\[Delta]b1$$ + $CellContext`a1$$], 
          $CellContext`nm[$CellContext`\[Delta]b2$$ + $CellContext`a2$$], 
          $CellContext`nm[$CellContext`a1$$], 
          $CellContext`nm[$CellContext`a2$$]], 
         Graphics[{Gray, 
           PointSize[0.01], 
           Point[{$CellContext`d$$/2, 0}], Green, 
           PointSize[0.01], 
           Point[{(-$CellContext`d$$)/2, 0}]}, Axes -> True], 
         PlotRange -> {0, $CellContext`h$$}], 
        LineLegend[{
          ColorData[97][2], 
          ColorData[97][1]}, {"scan", "image"}]], 
      "Specifications" :> {{{$CellContext`T1$$, 150}, 1, 
         200}, {{$CellContext`T2$$, 12}, 1, 200}, {{$CellContext`d$$, 90}, 10,
          500.00000000000006`}, {{$CellContext`\[Delta]b1$$, 5}, 1, 
         100}, {{$CellContext`\[Delta]b2$$, 5}, 1, 
         100}, {{$CellContext`a1$$, 37}, 10, 100}, {{$CellContext`a2$$, 44}, 
         10, 100}, {{$CellContext`h$$, 15}, 10, 
         1000}, {{$CellContext`w$$, 1.24}, 1, 4}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{4.503599627370496*^15, {170., 177.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.756505707452372*^9, 3.756505879287026*^9, 
  3.756506047408087*^9, 3.756932700676387*^9}]
}, Open  ]],

Cell["\<\
There has got be a good way to add some rigor to choosing b... 
I have a way of assigning the temperature\
\>", "Text",
 CellChangeTimes->{{3.7406039820563803`*^9, 3.740604027116426*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"radiusCalculator", "[", "length_", "]"}], ":=", " ", 
   RowBox[{"N", "[", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"40", "*", "35", "*", "length"}], ")"}], "*", 
       RowBox[{"3", "/", 
        RowBox[{"(", 
         RowBox[{"4", "\[Pi]"}], ")"}]}]}], ")"}], 
     RowBox[{"1", "/", "3"}]], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.756504520094983*^9, 3.756504587676758*^9}, {
  3.756504645964335*^9, 3.7565046498813257`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"radiusCalculator", "[", "150", "]"}]], "Input",
 CellChangeTimes->{{3.7565045892093287`*^9, 3.7565046134172783`*^9}}],

Cell[BoxData["36.873149012643275`"], "Output",
 CellChangeTimes->{3.756504614085037*^9, 3.756504653020135*^9, 
  3.756505550273972*^9, 3.756505682509156*^9, 3.756932701723852*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"radiusCalculator", "[", "250", "]"}]], "Input",
 CellChangeTimes->{3.7565046764550056`*^9}],

Cell[BoxData["43.71795227951175`"], "Output",
 CellChangeTimes->{3.756504677010187*^9, 3.756505550362458*^9, 
  3.7565056825792723`*^9, 3.756932701791436*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Hacking temperatures in scan model to be functions of temperature\
\>", "Subsection",
 CellChangeTimes->{{3.756732656716598*^9, 3.756732698410367*^9}}],

Cell[TextData[{
 "In order to fake the spacial dependence of the temperatures, I will set T1 \
and T2 to be the sum of two Gaussians. I will start with the assumption that \
the system will reach a given temperature distribution regardless of beam \
position. The magnitude of the distribution is set by the position of the \
beam. Therefore ",
 StyleBox["the ratio of ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", "1"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", "2"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " ",
 StyleBox["will be fixed.",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.756732779474718*^9, 3.75673282480332*^9}, {
  3.7567330979253073`*^9, 3.756733223547037*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.756733245456243*^9, 3.756733248759486*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "T1", " ", "will", " ", "be", " ", "the", " ", "sum", " ", "of", " ", 
     "two", " ", "gaussians"}], ",", " ", 
    RowBox[{
    "with", " ", "a", " ", "larger", " ", "one", " ", "centered", " ", "over",
      " ", "the", " ", "small", " ", "particle", " ", 
     RowBox[{"(", 
      RowBox[{"for", " ", "antibonding", " ", "mode"}], ")"}], " ", "and", 
     " ", "a", " ", "smaller", " ", "centered", " ", "over", " ", "the", " ", 
     
     RowBox[{"larger", ".", " ", "Each"}], " ", "Gaussian", " ", "will", " ", 
     "be", " ", "peaked", " ", "at", " ", "the", " ", "calculated", " ", 
     "temperature", " ", "for", " ", "each", " ", 
     RowBox[{"particle", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"T1ofx0", "[", 
      RowBox[{
      "x0_", ",", "A1_", ",", "A2_", ",", "w1_", ",", "w2_", ",", 
       "xParticle1_", ",", "xParticle2_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"A1", " ", 
       SuperscriptBox["E", 
        RowBox[{
         RowBox[{"-", "4"}], " ", 
         RowBox[{"Log", "[", "2", "]"}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x0", "-", "xParticle1"}], ")"}], "2"], "/", 
          RowBox[{"(", 
           SuperscriptBox["w1", "2"], ")"}]}]}]]}], "+", 
      RowBox[{"A2", " ", 
       SuperscriptBox["E", 
        RowBox[{
         RowBox[{"-", "4"}], 
         RowBox[{"Log", "[", "2", "]"}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x0", "-", "xParticle2"}], ")"}], "2"], "/", 
          RowBox[{"(", 
           SuperscriptBox["w2", "2"], ")"}]}]}]]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "In", " ", "terms", " ", "of", " ", "the", " ", "FWHM", " ", "w"}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "T2", " ", "will", " ", "be", " ", "proportional", " ", "to", " ", 
      "T1"}], ",", " ", 
     RowBox[{"reduced", " ", "by", " ", "some", " ", "constant", " ", 
      RowBox[{"factor", "."}]}]}], " ", "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"T2ofx0", "[", 
      RowBox[{
      "x0_", ",", "A1_", ",", "A2_", ",", "w1_", ",", "w2_", ",", 
       "xParticle1_", ",", "xParticle2_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"T1ofx0", "[", 
       RowBox[{
       "x0", ",", "A1", ",", "A2", ",", "w1", ",", "w2", ",", "xParticle1", 
        ",", "xParticle2"}], "]"}], "*", "0.9"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7567327070046177`*^9, 3.75673271783419*^9}, {
   3.7567332394234447`*^9, 3.75673347879453*^9}, {3.756733513992899*^9, 
   3.7567335351076517`*^9}, {3.7567375003508368`*^9, 3.756737529577867*^9}, {
   3.756737662354568*^9, 3.756737771235445*^9}, {3.75673844925578*^9, 
   3.756738470839904*^9}, {3.756738502629643*^9, 3.756738610409505*^9}, 
   3.7567405403801413`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Plot", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"DiffPowerScatt", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"hw", "/", "hbar"}], ",", "\[IndentingNewLine]", 
          RowBox[{"T1ofx0", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nm", "[", "x0", "]"}], ",", "\[IndentingNewLine]", "A1", 
            ",", "\[IndentingNewLine]", "A2", ",", "\[IndentingNewLine]", 
            "w1", ",", "\[IndentingNewLine]", "w2", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"nm", "[", "xParticle1", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"nm", "[", "xParticle2", "]"}]}], "\[IndentingNewLine]", 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"nm", "[", 
           RowBox[{"\[Delta]b1", "+", "a1"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"T2ofx0", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nm", "[", "x0", "]"}], ",", "\[IndentingNewLine]", "A1", 
            ",", "\[IndentingNewLine]", "A2", ",", "\[IndentingNewLine]", 
            "w1", ",", "\[IndentingNewLine]", "w2", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"nm", "[", "xParticle1", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"nm", "[", "xParticle2", "]"}]}], "\[IndentingNewLine]", 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"nm", "[", 
           RowBox[{"\[Delta]b2", "+", "a2"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"nm", "[", 
           RowBox[{"\[Delta]d", "+", "a1", "+", "a2"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"nm", "[", "x0", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"nm", "[", "a1", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"nm", "[", "a2", "]"}]}], "\[IndentingNewLine]", "]"}], "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"A1", "\[Rule]", "20"}], ",", "\[IndentingNewLine]", 
          RowBox[{"A2", "\[Rule]", "10"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{"w1", "\[Rule]", 
           RowBox[{"2", "\[Pi]", " ", 
            RowBox[{"c", "/", 
             RowBox[{"(", 
              RowBox[{"hw", "/", "hbar"}], ")"}]}]}]}], 
          RowBox[{"(*", 
           RowBox[{"\[Lambda]", "/", "2"}], "*)"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"w2", "\[Rule]", 
           RowBox[{"2", "\[Pi]", " ", 
            RowBox[{"c", "/", 
             RowBox[{"(", 
              RowBox[{"hw", "/", "hbar"}], ")"}]}]}]}], 
          RowBox[{"(*", 
           RowBox[{"\[Lambda]", "/", "2"}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"xParticle1", "->", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[Delta]d"}], "/", "2"}], "-", "a1"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"xParticle2", "->", " ", 
           RowBox[{
            RowBox[{"\[Delta]d", "/", "2"}], "+", "a2"}]}]}], " ", 
         "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"x0", ",", 
         RowBox[{
          RowBox[{"-", "sensorWidth"}], "/", "2"}], ",", 
         RowBox[{"sensorWidth", "/", "2"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"T1ofx0", "[", 
         RowBox[{
          RowBox[{"nm", "[", "x0", "]"}], ",", "A1", ",", "A2", ",", "w1", 
          ",", "w2", ",", 
          RowBox[{"nm", "[", "xParticle1", "]"}], ",", 
          RowBox[{"nm", "[", "xParticle2", "]"}]}], "]"}], "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"A1", "\[Rule]", "20"}], ",", "\[IndentingNewLine]", 
          RowBox[{"A2", "\[Rule]", "10"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{"w1", "\[Rule]", 
           RowBox[{"2", "\[Pi]", " ", 
            RowBox[{"c", "/", 
             RowBox[{"(", 
              RowBox[{"hw", "/", "hbar"}], ")"}]}]}]}], 
          RowBox[{"(*", 
           RowBox[{"\[Lambda]", "/", "2"}], "*)"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"w2", "\[Rule]", 
           RowBox[{"2", "\[Pi]", " ", 
            RowBox[{"c", "/", 
             RowBox[{"(", 
              RowBox[{"hw", "/", "hbar"}], ")"}]}]}]}], 
          RowBox[{"(*", 
           RowBox[{"\[Lambda]", "/", "2"}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"xParticle1", "->", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[Delta]d"}], "/", "2"}], "-", "a1"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"xParticle2", "->", " ", 
           RowBox[{
            RowBox[{"\[Delta]d", "/", "2"}], "+", "a2"}]}]}], " ", 
         "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"x0", ",", 
         RowBox[{
          RowBox[{"-", "sensorWidth"}], "/", "2"}], ",", 
         RowBox[{"sensorWidth", "/", "2"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "\[IndentingNewLine]", 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"DiffPowerScatt1", "[", 
          RowBox[{
           RowBox[{"hw", "/", "hbar"}], ",", "T1", ",", 
           RowBox[{"nm", "[", 
            RowBox[{"\[Delta]b1", "+", "a1"}], "]"}], ",", "T2", ",", 
           RowBox[{"nm", "[", 
            RowBox[{"\[Delta]b2", "+", "a2"}], "]"}], ",", 
           RowBox[{"nm", "[", 
            RowBox[{"\[Delta]d", "+", "a1", "+", "a2"}], "]"}], ",", 
           RowBox[{"nm", "[", "x0", "]"}], ",", 
           RowBox[{"nm", "[", "a1", "]"}], ",", 
           RowBox[{"nm", "[", "a2", "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x0", ",", 
           RowBox[{
            RowBox[{"-", "sensorWidth"}], "/", "2"}], ",", 
           RowBox[{"sensorWidth", "/", "2"}]}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
         RowBox[{"PlotStyle", "\[Rule]", "Green"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"DiffPowerScatt2", "[", 
          RowBox[{
           RowBox[{"hw", "/", "hbar"}], ",", "T1", ",", 
           RowBox[{"nm", "[", 
            RowBox[{"\[Delta]b1", "+", "a1"}], "]"}], ",", "T2", ",", 
           RowBox[{"nm", "[", 
            RowBox[{"\[Delta]b2", "+", "a2"}], "]"}], ",", 
           RowBox[{"nm", "[", 
            RowBox[{"\[Delta]d", "+", "a1", "+", "a2"}], "]"}], ",", 
           RowBox[{"nm", "[", "x0", "]"}], ",", 
           RowBox[{"nm", "[", "a1", "]"}], ",", 
           RowBox[{"nm", "[", "a2", "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x0", ",", 
           RowBox[{
            RowBox[{"-", "sensorWidth"}], "/", "2"}], ",", 
           RowBox[{"sensorWidth", "/", "2"}]}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Gray"}]}], "]"}], ","}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Green", ",", 
         RowBox[{"PointSize", "[", ".01", "]"}], ",", 
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[Delta]d"}], "/", "2"}], "-", "a1"}], ",", "0"}],
            "}"}], "]"}], ",", "\[IndentingNewLine]", "Gray", ",", 
         RowBox[{"PointSize", "[", ".01", "]"}], ",", 
         RowBox[{"Point", "[", 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Delta]d", "/", "2"}], "+", "a2"}], " ", ",", "0"}], 
           "}"}], "]"}]}], "}"}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}]}], "\[IndentingNewLine]", "\t", 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<scan\>\"", ",", 
        RowBox[{"FontSize", "\[Rule]", "18"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"T1", ",", "15"}], "}"}], ",", "1", ",", "200"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"T2", ",", "12"}], "}"}], ",", "1", ",", "200"}], "}"}], 
     ","}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Delta]d", ",", "10"}], "}"}], ",", "10", ",", 
     RowBox[{"1240", "/", "2.48"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Delta]b1", ",", "5"}], "}"}], ",", "1", ",", "100"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Delta]b2", ",", "5"}], "}"}], ",", "1", ",", "100"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a1", ",", "37"}], "}"}], ",", "10", ",", "100"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a2", ",", "44"}], "}"}], ",", "10", ",", "100"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"hw", ",", "2.48"}], "}"}], ",", "1", ",", "6"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.740075973494215*^9, 3.740075994925561*^9}, {
   3.74007606271894*^9, 3.7400761133553333`*^9}, {3.756486660307789*^9, 
   3.756486670898929*^9}, {3.7565638095237226`*^9, 3.756563856230604*^9}, 
   3.7565639085504017`*^9, {3.756564013577194*^9, 3.756564014760182*^9}, {
   3.7565649050753727`*^9, 3.756564940500061*^9}, {3.7565649732769613`*^9, 
   3.756564982295787*^9}, {3.7565650260929537`*^9, 3.756565035097147*^9}, {
   3.7565675806714897`*^9, 3.756567595809835*^9}, {3.756737908417148*^9, 
   3.756737932647107*^9}, 3.7567380020735693`*^9, {3.756738044580997*^9, 
   3.756738164886341*^9}, {3.756738568951803*^9, 3.756738572642964*^9}, {
   3.7567386319936867`*^9, 3.7567386631804*^9}, {3.756738763310018*^9, 
   3.7567389014338713`*^9}, {3.756738955591514*^9, 3.75673901096561*^9}, {
   3.7567390957817087`*^9, 3.756739106123057*^9}, {3.756739145404841*^9, 
   3.756739164076882*^9}, {3.75673921192232*^9, 3.756739283965616*^9}, {
   3.756739344104233*^9, 3.7567393581943073`*^9}, {3.756739469280302*^9, 
   3.756739513993617*^9}, {3.7567395905491943`*^9, 3.756739668487068*^9}, {
   3.756739738078171*^9, 3.756739788782887*^9}, {3.756739858358363*^9, 
   3.7567399277672253`*^9}, {3.7567405507561693`*^9, 3.756740570403702*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a1$$ = 37, $CellContext`a2$$ = 
    44, $CellContext`hw$$ = 2.48, $CellContext`\[Delta]b1$$ = 
    5, $CellContext`\[Delta]b2$$ = 5, $CellContext`\[Delta]d$$ = 10, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`\[Delta]d$$], 10}, 10, 500.00000000000006`}, {{
       Hold[$CellContext`\[Delta]b1$$], 5}, 1, 100}, {{
       Hold[$CellContext`\[Delta]b2$$], 5}, 1, 100}, {{
       Hold[$CellContext`a1$$], 37}, 10, 100}, {{
       Hold[$CellContext`a2$$], 44}, 10, 100}, {{
       Hold[$CellContext`hw$$], 2.48}, 1, 6}}, Typeset`size$$ = {
    450., {147., 154.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`\[Delta]d$2665$$ = 
    0, $CellContext`\[Delta]b1$2666$$ = 0, $CellContext`\[Delta]b2$2667$$ = 
    0, $CellContext`a1$2668$$ = 0, $CellContext`a2$2669$$ = 
    0, $CellContext`hw$2670$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a1$$ = 37, $CellContext`a2$$ = 
        44, $CellContext`hw$$ = 2.48, $CellContext`\[Delta]b1$$ = 
        5, $CellContext`\[Delta]b2$$ = 5, $CellContext`\[Delta]d$$ = 10}, 
      "ControllerVariables" :> {
        Hold[$CellContext`\[Delta]d$$, $CellContext`\[Delta]d$2665$$, 0], 
        Hold[$CellContext`\[Delta]b1$$, $CellContext`\[Delta]b1$2666$$, 0], 
        Hold[$CellContext`\[Delta]b2$$, $CellContext`\[Delta]b2$2667$$, 0], 
        Hold[$CellContext`a1$$, $CellContext`a1$2668$$, 0], 
        Hold[$CellContext`a2$$, $CellContext`a2$2669$$, 0], 
        Hold[$CellContext`hw$$, $CellContext`hw$2670$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Show[
        Plot[
         ReplaceAll[
          $CellContext`DiffPowerScatt[$CellContext`hw$$/$CellContext`hbar, 
           $CellContext`T1ofx0[
            $CellContext`nm[$CellContext`x0], $CellContext`A1, \
$CellContext`A2, $CellContext`w1, $CellContext`w2, 
            $CellContext`nm[$CellContext`xParticle1], 
            $CellContext`nm[$CellContext`xParticle2]], 
           $CellContext`nm[$CellContext`\[Delta]b1$$ + $CellContext`a1$$], 
           $CellContext`T2ofx0[
            $CellContext`nm[$CellContext`x0], $CellContext`A1, \
$CellContext`A2, $CellContext`w1, $CellContext`w2, 
            $CellContext`nm[$CellContext`xParticle1], 
            $CellContext`nm[$CellContext`xParticle2]], 
           $CellContext`nm[$CellContext`\[Delta]b2$$ + $CellContext`a2$$], 
           $CellContext`nm[$CellContext`\[Delta]d$$ + $CellContext`a1$$ + \
$CellContext`a2$$], 
           $CellContext`nm[$CellContext`x0], 
           $CellContext`nm[$CellContext`a1$$], 
           $CellContext`nm[$CellContext`a2$$]], {$CellContext`A1 -> 
           20, $CellContext`A2 -> 10, $CellContext`w1 -> 
           2 Pi ($CellContext`c/($CellContext`hw$$/$CellContext`hbar)), \
$CellContext`w2 -> 
           2 Pi ($CellContext`c/($CellContext`hw$$/$CellContext`hbar)), \
$CellContext`xParticle1 -> (-$CellContext`\[Delta]d$$)/
             2 - $CellContext`a1$$, $CellContext`xParticle2 -> $CellContext`\
\[Delta]d$$/
             2 + $CellContext`a2$$}], {$CellContext`x0, \
(-$CellContext`sensorWidth)/2, $CellContext`sensorWidth/2}, PlotRange -> All], 
        Plot[
         ReplaceAll[
          $CellContext`T1ofx0[
           $CellContext`nm[$CellContext`x0], $CellContext`A1, \
$CellContext`A2, $CellContext`w1, $CellContext`w2, 
           $CellContext`nm[$CellContext`xParticle1], 
           $CellContext`nm[$CellContext`xParticle2]], {$CellContext`A1 -> 
           20, $CellContext`A2 -> 10, $CellContext`w1 -> 
           2 Pi ($CellContext`c/($CellContext`hw$$/$CellContext`hbar)), \
$CellContext`w2 -> 
           2 Pi ($CellContext`c/($CellContext`hw$$/$CellContext`hbar)), \
$CellContext`xParticle1 -> (-$CellContext`\[Delta]d$$)/
             2 - $CellContext`a1$$, $CellContext`xParticle2 -> $CellContext`\
\[Delta]d$$/
             2 + $CellContext`a2$$}], {$CellContext`x0, \
(-$CellContext`sensorWidth)/2, $CellContext`sensorWidth/2}, PlotStyle -> Red], 
        Graphics[{Green, 
          PointSize[0.01], 
          Point[{(-$CellContext`\[Delta]d$$)/2 - $CellContext`a1$$, 0}], Gray, 
          PointSize[0.01], 
          Point[{$CellContext`\[Delta]d$$/2 + $CellContext`a2$$, 0}]}, Axes -> 
         True], PlotLabel -> Style["scan", FontSize -> 18]], 
      "Specifications" :> {{{$CellContext`\[Delta]d$$, 10}, 10, 
         500.00000000000006`}, {{$CellContext`\[Delta]b1$$, 5}, 1, 
         100}, {{$CellContext`\[Delta]b2$$, 5}, 1, 
         100}, {{$CellContext`a1$$, 37}, 10, 100}, {{$CellContext`a2$$, 44}, 
         10, 100}, {{$CellContext`hw$$, 2.48}, 1, 6}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{505., {273., 280.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.7567389125167217`*^9, {3.756738984655774*^9, 3.7567390140552263`*^9}, {
   3.756739099126006*^9, 3.7567391092052507`*^9}, 3.756739165257782*^9, 
   3.756739215175703*^9, 3.756739285691382*^9, 3.756739359491191*^9, {
   3.7567394862288837`*^9, 3.7567395173142843`*^9}, 3.756739668992035*^9, {
   3.756739863921682*^9, 3.756739929394822*^9}, 3.756740584949417*^9, 
   3.756932702058176*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nm", "[", 
  RowBox[{"\[Pi]", " ", 
   RowBox[{"c", "/", 
    RowBox[{"(", 
     RowBox[{"2.5", "/", "hbar"}], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.756739687973073*^9, 3.75673968878445*^9}, {
  3.756739817180317*^9, 3.756739819246313*^9}}],

Cell[BoxData["2.4797013044836885`*^-12"], "Output",
 CellChangeTimes->{3.756739689321886*^9, 3.756739819702568*^9, 
  3.756932702991098*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{991, 755},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 76, 1, 39, "Input"],
Cell[CellGroupData[{
Cell[659, 25, 100, 1, 39, "Input"],
Cell[762, 28, 197, 3, 39, "Output"]
}, Open  ]],
Cell[974, 34, 383, 8, 85, "Text"],
Cell[1360, 44, 3855, 92, 457, "Input"],
Cell[5218, 138, 117, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[5360, 143, 262, 5, 43, "Subsubsection"],
Cell[5625, 150, 3556, 84, 228, "Input"],
Cell[9184, 236, 115, 1, 37, "Text"],
Cell[9302, 239, 3283, 74, 222, "Input"],
Cell[12588, 315, 229, 4, 37, "Text"],
Cell[12820, 321, 3688, 86, 333, "Input"],
Cell[16511, 409, 105, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[16641, 414, 142, 3, 39, "Input"],
Cell[16786, 419, 228, 4, 39, "Output"]
}, Open  ]],
Cell[17029, 426, 2124, 62, 250, "Input"],
Cell[CellGroupData[{
Cell[19178, 492, 105, 3, 40, "Input"],
Cell[19286, 497, 526, 9, 39, "Output"]
}, Open  ]],
Cell[19827, 509, 128, 1, 37, "Text"],
Cell[19958, 512, 8023, 190, 664, "Input"],
Cell[27984, 704, 89, 1, 66, "Input"],
Cell[28076, 707, 103, 1, 37, "Text"],
Cell[28182, 710, 4222, 91, 378, "Input"],
Cell[32407, 803, 107, 1, 37, "Text"],
Cell[32517, 806, 4824, 110, 612, "Input"],
Cell[37344, 918, 1542, 37, 222, "Input"],
Cell[38889, 957, 87, 1, 66, "Input"],
Cell[38979, 960, 87, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[39091, 965, 4813, 122, 560, "Input"],
Cell[43907, 1089, 5788, 108, 575, "Output"]
}, Open  ]],
Cell[49710, 1200, 171, 2, 37, "Text"],
Cell[49884, 1204, 87, 1, 66, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50008, 1210, 128, 1, 43, "Subsubsection"],
Cell[50139, 1213, 315, 9, 40, "Input"],
Cell[50457, 1224, 869, 23, 144, "Input"],
Cell[51329, 1249, 6034, 162, 664, "Input"],
Cell[57366, 1413, 2862, 75, 274, "Input"],
Cell[60231, 1490, 2803, 74, 274, "Input"],
Cell[63037, 1566, 111, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[63173, 1571, 224, 5, 39, "Input"],
Cell[63400, 1578, 211, 3, 40, "Output"]
}, Open  ]],
Cell[63626, 1584, 2605, 71, 326, "Input"],
Cell[66234, 1657, 2610, 71, 326, "Input"],
Cell[68847, 1730, 784, 18, 92, "Input"],
Cell[69634, 1750, 785, 18, 92, "Input"],
Cell[70422, 1770, 789, 18, 92, "Input"],
Cell[71214, 1790, 1340, 32, 124, "Input"],
Cell[72557, 1824, 914, 21, 92, "Input"],
Cell[73474, 1847, 915, 21, 92, "Input"],
Cell[CellGroupData[{
Cell[74414, 1872, 5114, 121, 586, "Input"],
Cell[79531, 1995, 5720, 102, 397, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85288, 2102, 5618, 142, 612, "Input"],
Cell[90909, 2246, 6263, 116, 393, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97209, 2367, 6211, 151, 612, "Input"],
Cell[103423, 2520, 5054, 95, 367, "Output"]
}, Open  ]],
Cell[108492, 2618, 197, 4, 61, "Text"],
Cell[108692, 2624, 534, 15, 43, "Input"],
Cell[CellGroupData[{
Cell[109251, 2643, 141, 2, 39, "Input"],
Cell[109395, 2647, 179, 2, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109611, 2654, 115, 2, 39, "Input"],
Cell[109729, 2658, 158, 2, 39, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[109936, 2666, 161, 3, 67, "Subsection"],
Cell[110100, 2671, 799, 22, 111, "Text"],
Cell[110902, 2695, 92, 1, 39, "Input"],
Cell[110997, 2698, 3144, 79, 439, "Input"],
Cell[CellGroupData[{
Cell[114166, 2781, 11108, 256, 1860, "Input"],
Cell[125277, 3039, 5995, 111, 573, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131309, 3155, 276, 7, 39, "Input"],
Cell[131588, 3164, 140, 2, 40, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

